<!DOCTYPE html>
<!-- saved from url=(0032)https://ragulpr.github.io/page2/ -->
<html lang="en-us"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Focus on the objective · Egils blog
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="./Focus on the objective · Egils blog_files/poole.css">
  <link rel="stylesheet" href="./Focus on the objective · Egils blog_files/syntax.css">
  <link rel="stylesheet" href="./Focus on the objective · Egils blog_files/lanyon.css">
  <link rel="stylesheet" href="./Focus on the objective · Egils blog_files/css">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://ragulpr.github.io/public/apple-touch-icon-precomposed.png">
  <link rel="shortcut icon" href="https://ragulpr.github.io/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="https://ragulpr.github.io/atom.xml">

  <!-- Enable Mathjax -->

  <script async="" src="./Focus on the objective · Egils blog_files/analytics.js"></script><script src="./Focus on the objective · Egils blog_files/MathJax.js" id="">
  </script>

<script type="text/javascript" async="" src="./Focus on the objective · Egils blog_files/embed-controller.js" charset="utf-8"></script><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.imgur-embed-iframe-pub { box-shadow: 0px 0px 5px 0px rgba(0, 0, 0, 0.10); border: 1px solid #ddd; border-radius: 2px;}</style><style type="text/css">.mjx-chtml {display: inline-block; line-height: 0; text-indent: 0; text-align: left; text-transform: none; font-style: normal; font-weight: normal; font-size: 100%; font-size-adjust: none; letter-spacing: normal; word-wrap: normal; word-spacing: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; margin: 0; padding: 1px 0}
.MJXc-display {display: block; text-align: center; margin: 1em 0; padding: 0}
.mjx-chtml[tabindex]:focus, body :focus .mjx-chtml[tabindex] {display: inline-table}
.mjx-full-width {text-align: center; display: table-cell!important; width: 10000em}
.mjx-math {display: inline-block; border-collapse: separate; border-spacing: 0}
.mjx-math * {display: inline-block; -webkit-box-sizing: content-box!important; -moz-box-sizing: content-box!important; box-sizing: content-box!important; text-align: left}
.mjx-numerator {display: block; text-align: center}
.mjx-denominator {display: block; text-align: center}
.MJXc-stacked {height: 0; position: relative}
.MJXc-stacked > * {position: absolute}
.MJXc-bevelled > * {display: inline-block}
.mjx-stack {display: inline-block}
.mjx-op {display: block}
.mjx-under {display: table-cell}
.mjx-over {display: block}
.mjx-over > * {padding-left: 0px!important; padding-right: 0px!important}
.mjx-under > * {padding-left: 0px!important; padding-right: 0px!important}
.mjx-stack > .mjx-sup {display: block}
.mjx-stack > .mjx-sub {display: block}
.mjx-prestack > .mjx-presup {display: block}
.mjx-prestack > .mjx-presub {display: block}
.mjx-delim-h > .mjx-char {display: inline-block}
.mjx-surd {vertical-align: top}
.mjx-mphantom * {visibility: hidden}
.mjx-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 2px 3px; font-style: normal; font-size: 90%}
.mjx-annotation-xml {line-height: normal}
.mjx-menclose > svg {fill: none; stroke: currentColor}
.mjx-mtr {display: table-row}
.mjx-mlabeledtr {display: table-row}
.mjx-mtd {display: table-cell; text-align: center}
.mjx-label {display: table-row}
.mjx-box {display: inline-block}
.mjx-block {display: block}
.mjx-span {display: inline}
.mjx-char {display: block; white-space: pre}
.mjx-itable {display: inline-table; width: auto}
.mjx-row {display: table-row}
.mjx-cell {display: table-cell}
.mjx-table {display: table; width: 100%}
.mjx-line {display: block; height: 0}
.mjx-strut {width: 0; padding-top: 1em}
.mjx-vsize {width: 0}
.MJXc-space1 {margin-left: .167em}
.MJXc-space2 {margin-left: .222em}
.MJXc-space3 {margin-left: .278em}
.mjx-chartest {display: block; visibility: hidden; position: absolute; top: 0; line-height: normal; font-size: 500%}
.mjx-chartest .mjx-char {display: inline}
.mjx-chartest .mjx-box {padding-top: 1000px}
.MJXc-processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MJXc-processed {display: none}
.mjx-test {display: block; font-style: normal; font-weight: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow: hidden; height: 1px}
.mjx-ex-box-test {position: absolute; width: 1px; height: 60ex}
.mjx-line-box-test {display: table!important}
.mjx-line-box-test span {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
#MathJax_CHTML_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.mjx-chtml .mjx-noError {line-height: 1.2; vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
.MJXc-TeX-unknown-R {font-family: STIXGeneral,'Cambria Math','Arial Unicode MS',serif; font-style: normal; font-weight: normal}
.MJXc-TeX-unknown-I {font-family: STIXGeneral,'Cambria Math','Arial Unicode MS',serif; font-style: italic; font-weight: normal}
.MJXc-TeX-unknown-B {font-family: STIXGeneral,'Cambria Math','Arial Unicode MS',serif; font-style: normal; font-weight: bold}
.MJXc-TeX-unknown-BI {font-family: STIXGeneral,'Cambria Math','Arial Unicode MS',serif; font-style: italic; font-weight: bold}
.MJXc-TeX-ams-R {font-family: MJXc-TeX-ams-R,MJXc-TeX-ams-Rw}
.MJXc-TeX-cal-B {font-family: MJXc-TeX-cal-B,MJXc-TeX-cal-Bx,MJXc-TeX-cal-Bw}
.MJXc-TeX-frak-R {font-family: MJXc-TeX-frak-R,MJXc-TeX-frak-Rw}
.MJXc-TeX-frak-B {font-family: MJXc-TeX-frak-B,MJXc-TeX-frak-Bx,MJXc-TeX-frak-Bw}
.MJXc-TeX-math-BI {font-family: MJXc-TeX-math-BI,MJXc-TeX-math-BIx,MJXc-TeX-math-BIw}
.MJXc-TeX-sans-R {font-family: MJXc-TeX-sans-R,MJXc-TeX-sans-Rw}
.MJXc-TeX-sans-B {font-family: MJXc-TeX-sans-B,MJXc-TeX-sans-Bx,MJXc-TeX-sans-Bw}
.MJXc-TeX-sans-I {font-family: MJXc-TeX-sans-I,MJXc-TeX-sans-Ix,MJXc-TeX-sans-Iw}
.MJXc-TeX-script-R {font-family: MJXc-TeX-script-R,MJXc-TeX-script-Rw}
.MJXc-TeX-type-R {font-family: MJXc-TeX-type-R,MJXc-TeX-type-Rw}
.MJXc-TeX-cal-R {font-family: MJXc-TeX-cal-R,MJXc-TeX-cal-Rw}
.MJXc-TeX-main-B {font-family: MJXc-TeX-main-B,MJXc-TeX-main-Bx,MJXc-TeX-main-Bw}
.MJXc-TeX-main-I {font-family: MJXc-TeX-main-I,MJXc-TeX-main-Ix,MJXc-TeX-main-Iw}
.MJXc-TeX-main-R {font-family: MJXc-TeX-main-R,MJXc-TeX-main-Rw}
.MJXc-TeX-math-I {font-family: MJXc-TeX-math-I,MJXc-TeX-math-Ix,MJXc-TeX-math-Iw}
.MJXc-TeX-size1-R {font-family: MJXc-TeX-size1-R,MJXc-TeX-size1-Rw}
.MJXc-TeX-size2-R {font-family: MJXc-TeX-size2-R,MJXc-TeX-size2-Rw}
.MJXc-TeX-size3-R {font-family: MJXc-TeX-size3-R,MJXc-TeX-size3-Rw}
.MJXc-TeX-size4-R {font-family: MJXc-TeX-size4-R,MJXc-TeX-size4-Rw}
@font-face {font-family: MJXc-TeX-ams-R; src: local('MathJax_AMS'), local('MathJax_AMS-Regular')}
@font-face {font-family: MJXc-TeX-ams-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_AMS-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_AMS-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_AMS-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-cal-B; src: local('MathJax_Caligraphic Bold'), local('MathJax_Caligraphic-Bold')}
@font-face {font-family: MJXc-TeX-cal-Bx; src: local('MathJax_Caligraphic'); font-weight: bold}
@font-face {font-family: MJXc-TeX-cal-Bw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Caligraphic-Bold.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Bold.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Bold.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-frak-R; src: local('MathJax_Fraktur'), local('MathJax_Fraktur-Regular')}
@font-face {font-family: MJXc-TeX-frak-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Fraktur-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Fraktur-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Fraktur-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-frak-B; src: local('MathJax_Fraktur Bold'), local('MathJax_Fraktur-Bold')}
@font-face {font-family: MJXc-TeX-frak-Bx; src: local('MathJax_Fraktur'); font-weight: bold}
@font-face {font-family: MJXc-TeX-frak-Bw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Fraktur-Bold.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Fraktur-Bold.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Fraktur-Bold.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-math-BI; src: local('MathJax_Math BoldItalic'), local('MathJax_Math-BoldItalic')}
@font-face {font-family: MJXc-TeX-math-BIx; src: local('MathJax_Math'); font-weight: bold; font-style: italic}
@font-face {font-family: MJXc-TeX-math-BIw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Math-BoldItalic.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Math-BoldItalic.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Math-BoldItalic.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-sans-R; src: local('MathJax_SansSerif'), local('MathJax_SansSerif-Regular')}
@font-face {font-family: MJXc-TeX-sans-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_SansSerif-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_SansSerif-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_SansSerif-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-sans-B; src: local('MathJax_SansSerif Bold'), local('MathJax_SansSerif-Bold')}
@font-face {font-family: MJXc-TeX-sans-Bx; src: local('MathJax_SansSerif'); font-weight: bold}
@font-face {font-family: MJXc-TeX-sans-Bw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_SansSerif-Bold.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_SansSerif-Bold.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_SansSerif-Bold.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-sans-I; src: local('MathJax_SansSerif Italic'), local('MathJax_SansSerif-Italic')}
@font-face {font-family: MJXc-TeX-sans-Ix; src: local('MathJax_SansSerif'); font-style: italic}
@font-face {font-family: MJXc-TeX-sans-Iw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_SansSerif-Italic.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_SansSerif-Italic.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_SansSerif-Italic.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-script-R; src: local('MathJax_Script'), local('MathJax_Script-Regular')}
@font-face {font-family: MJXc-TeX-script-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Script-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Script-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Script-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-type-R; src: local('MathJax_Typewriter'), local('MathJax_Typewriter-Regular')}
@font-face {font-family: MJXc-TeX-type-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Typewriter-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Typewriter-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Typewriter-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-cal-R; src: local('MathJax_Caligraphic'), local('MathJax_Caligraphic-Regular')}
@font-face {font-family: MJXc-TeX-cal-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Caligraphic-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-main-B; src: local('MathJax_Main Bold'), local('MathJax_Main-Bold')}
@font-face {font-family: MJXc-TeX-main-Bx; src: local('MathJax_Main'); font-weight: bold}
@font-face {font-family: MJXc-TeX-main-Bw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Main-Bold.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-main-I; src: local('MathJax_Main Italic'), local('MathJax_Main-Italic')}
@font-face {font-family: MJXc-TeX-main-Ix; src: local('MathJax_Main'); font-style: italic}
@font-face {font-family: MJXc-TeX-main-Iw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Main-Italic.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-main-R; src: local('MathJax_Main'), local('MathJax_Main-Regular')}
@font-face {font-family: MJXc-TeX-main-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Main-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-math-I; src: local('MathJax_Math Italic'), local('MathJax_Math-Italic')}
@font-face {font-family: MJXc-TeX-math-Ix; src: local('MathJax_Math'); font-style: italic}
@font-face {font-family: MJXc-TeX-math-Iw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Math-Italic.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-size1-R; src: local('MathJax_Size1'), local('MathJax_Size1-Regular')}
@font-face {font-family: MJXc-TeX-size1-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Size1-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-size2-R; src: local('MathJax_Size2'), local('MathJax_Size2-Regular')}
@font-face {font-family: MJXc-TeX-size2-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Size2-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-size3-R; src: local('MathJax_Size3'), local('MathJax_Size3-Regular')}
@font-face {font-family: MJXc-TeX-size3-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Size3-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-size4-R; src: local('MathJax_Size4'), local('MathJax_Size4-Regular')}
@font-face {font-family: MJXc-TeX-size4-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Size4-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf') format('opentype')}
</style><style type="text/css">#imgur-embed-iframe-pub-klNuiZe { height: 324px !important;width:540px !important;}</style><style type="text/css">#imgur-embed-iframe-pub-6s17rOU { height: 324px !important;width:540px !important;}</style><style type="text/css">#imgur-embed-iframe-pub-0JyrJKz { height: 402px !important;width:540px !important;}</style><style type="text/css">#imgur-embed-iframe-pub-zUgJdpd { height: 403px !important;width:540px !important;}</style><style type="text/css">#imgur-embed-iframe-pub-Yo1QPxU { height: 644px !important;width:540px !important;}</style><style type="text/css">#imgur-embed-iframe-pub-LGacYzO { height: 678px !important;width:540px !important;}</style><style type="text/css">#imgur-embed-iframe-pub-eR2OPmP { height: 454px !important;width:540px !important;}</style><style type="text/css">#imgur-embed-iframe-pub-Cjz1yfm { height: 324px !important;width:540px !important;}</style><style type="text/css">#imgur-embed-iframe-pub-KfE4eKz { height: 402px !important;width:540px !important;}</style><style type="text/css">#imgur-embed-iframe-pub-xTzd7KT { height: 324px !important;width:540px !important;}</style><style type="text/css">#imgur-embed-iframe-pub-maUHyto { height: 479px !important;width:540px !important;}</style></head>


  <body><div id="MathJax_Message" style="display: none;"></div>

    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <p>Blog about Machine Learning, data science and stuff.</p>
  </div>

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item" href="https://ragulpr.github.io/">Home</a>

    

    
    
      
        
      
    
      
        
      
    
      
        
          <a class="sidebar-nav-item" href="https://ragulpr.github.io/about/">About</a>
        
      
    
      
    
      
    
      
        
      
    
    <a class="sidebar-nav-item" href="https://ragulpr.github.io/2016/12/22/WTTE-RNN-Hackless-churn-modeling/">Churn prediction</a>
    <a class="sidebar-nav-item" href="https://ragulpr.github.io/assets/draft_master_thesis_martinsson_egil_wtte_rnn_2016.pdf">MsC thesis</a>
  </nav>
  <div class="sidebar-item">
    <p>
      Egil Martinsson
    </p>
    <p>
      © 2018. All rights reserved.  
    </p>
  </div>
</div>


    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="https://ragulpr.github.io/" title="Home">Focus on the objective</a>
            <small>Egils blog</small>
          </h3>
        </div>
      </div>

      <div class="container content">
        <div class="posts">
  
  <div class="post">
    <h1 class="post-title">
      <a href="https://ragulpr.github.io/2016/12/22/WTTE-RNN-Hackless-churn-modeling/">
        WTTE-RNN - Less hacky churn prediction
      </a>
    </h1>

    <span class="post-date">22 Dec 2016</span>

    <p>(How to model and predict churn using deep learning)</p>

<p><em>Mobile readers be aware: this article contains many heavy gifs</em></p>

<p>Churn prediction is one of the most common machine-learning problems in industry. The task is to predict whether customers are about to leave, i.e <em>churn</em>. You can’t imagine how many complex and hacky ways there are to do this. The topic of this post is how to avoid these pitfalls by choosing a smart modeling strategy and by using what I think is a pretty neat machine-learning model, what I call the WTTE-RNN.</p>

<p>The real trick is to define the problem in a way that makes the solution obvious. In doing so it becomes identical to that of trying to predict when patients will die, when machines will fail or when an earthquake is about to hit. It turns out that the model that I’ll tell you about might be a good solution for those problems too. And yes, of course it involves deep learning but I won’t talk much about it here. The focus is on the objective (function) which you can use with any machine learning model.</p>

<p>Table of contents:</p>

<ul id="markdown-toc">
  <li><a href="https://ragulpr.github.io/page2/#churn-prediction-is-hard" id="markdown-toc-churn-prediction-is-hard">Churn prediction is hard</a>    <ul>
      <li><a href="https://ragulpr.github.io/page2/#churn-prediction--non-event-prediction" id="markdown-toc-churn-prediction--non-event-prediction">Churn prediction = non-event prediction</a></li>
      <li><a href="https://ragulpr.github.io/page2/#censored-data" id="markdown-toc-censored-data">Censored data</a></li>
    </ul>
  </li>
  <li><a href="https://ragulpr.github.io/page2/#models-for-censored-data" id="markdown-toc-models-for-censored-data">Models for censored data</a>    <ul>
      <li><a href="https://ragulpr.github.io/page2/#sliding-box-model" id="markdown-toc-sliding-box-model">Sliding box model</a>        <ul>
          <li><a href="https://ragulpr.github.io/page2/#use-as-a-churn-model" id="markdown-toc-use-as-a-churn-model">Use as a churn-model</a></li>
        </ul>
      </li>
      <li><a href="https://ragulpr.github.io/page2/#making-it-a-learning-to-rank-problem" id="markdown-toc-making-it-a-learning-to-rank-problem">Making it a <em>learning to rank</em>-problem.</a></li>
    </ul>
  </li>
  <li><a href="https://ragulpr.github.io/page2/#what-we-want-in-a-churn-model" id="markdown-toc-what-we-want-in-a-churn-model">What we want in a churn-model</a></li>
  <li><a href="https://ragulpr.github.io/page2/#wtte-rnn" id="markdown-toc-wtte-rnn">WTTE-RNN</a>    <ul>
      <li><a href="https://ragulpr.github.io/page2/#training-with-censored-data" id="markdown-toc-training-with-censored-data">Training with censored data</a></li>
      <li><a href="https://ragulpr.github.io/page2/#embrace-the-weibull-euphoria" id="markdown-toc-embrace-the-weibull-euphoria">Embrace the Weibull Euphoria</a>        <ul>
          <li><a href="https://ragulpr.github.io/page2/#gradient-descent-over-weibull-surfaces" id="markdown-toc-gradient-descent-over-weibull-surfaces">Gradient descent over Weibull surfaces</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="https://ragulpr.github.io/page2/#implementation--experiments" id="markdown-toc-implementation--experiments">Implementation &amp; Experiments</a>    <ul>
      <li><a href="https://ragulpr.github.io/page2/#predicting-evenly-spaced-points" id="markdown-toc-predicting-evenly-spaced-points">Predicting evenly spaced points</a></li>
      <li><a href="https://ragulpr.github.io/page2/#predicting-the-destruction-of-jet-engines" id="markdown-toc-predicting-the-destruction-of-jet-engines">Predicting the destruction of jet-engines</a></li>
      <li><a href="https://ragulpr.github.io/page2/#how-to-use-wtte-rnn-as-a-churn-model" id="markdown-toc-how-to-use-wtte-rnn-as-a-churn-model">How to use WTTE-RNN as a churn-model</a>        <ul>
          <li><a href="https://ragulpr.github.io/page2/#wtte-rnn-produces-risk-embeddings" id="markdown-toc-wtte-rnn-produces-risk-embeddings">WTTE-RNN produces risk-embeddings</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="https://ragulpr.github.io/page2/#summary" id="markdown-toc-summary">Summary</a>    <ul>
      <li><a href="https://ragulpr.github.io/page2/#links" id="markdown-toc-links">links</a></li>
    </ul>
  </li>
</ul>

<h2 id="churn-prediction-is-hard">Churn prediction is hard</h2>
<p>There’s been a couple of great <a href="https://engineering.shopify.com/17488468-defining-churn-rate-no-really-this-actually-requires-an-entire-blog-post">articles</a> where the author is almost ashamed to admit how hard it is to define an aggregate churn metric. I think they could have gone further than that. Even here they assumed that the definition of a churned customer is written in stone which is typically not the case. You only need to google ‘churn prediction’ to realize that a bunch of stakeholders have this scary idealized view of the problem:</p>

<blockquote>
  <p>Customer <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-1-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-1" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2" class="mjx-mrow"><span id="MJXc-Node-3" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">n</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-1">n</script> has a feature vector <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-2-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-4" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-5" class="mjx-mrow"><span id="MJXc-Node-6" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-7" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">x</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-8" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">n</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>x</mi><mi>n</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-2">x^n</script> and a binary target value <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-3-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-9" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-10" class="mjx-mrow"><span id="MJXc-Node-11" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-12" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.489em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0.082em; padding-right: 0.071em;"><span id="MJXc-Node-13" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">n</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>y</mi><mi>n</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-3">y^n</script>:</p>

  <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-4-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msup&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;{&lt;/mo&gt;&lt;mtable columnalign=&quot;left left&quot; rowspacing=&quot;.2em&quot; columnspacing=&quot;1em&quot; displaystyle=&quot;false&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mtext&gt;&amp;#xA0;if customer&amp;#xA0;&lt;/mtext&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mtext&gt;&amp;#xA0;will churn&lt;/mtext&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mtext&gt;&amp;#xA0;if customer&amp;#xA0;&lt;/mtext&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mtext&gt;&amp;#xA0;won&#39;t churn&lt;/mtext&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo fence=&quot;true&quot; stretchy=&quot;true&quot; symmetric=&quot;true&quot;&gt;&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-14" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-15" class="mjx-mrow"><span id="MJXc-Node-16" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-17" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.489em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.082em; padding-right: 0.071em;"><span id="MJXc-Node-18" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">n</span></span></span></span><span id="MJXc-Node-19" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.091em; padding-bottom: 0.312em;">=</span></span><span id="MJXc-Node-20" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-21" class="mjx-mo"><span class="mjx-char MJXc-TeX-size3-R" style="padding-top: 1.241em; padding-bottom: 1.241em;">{</span></span><span id="MJXc-Node-22" class="mjx-mtable" style="vertical-align: -0.85em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-23" class="mjx-mtr" style="height: 1.1em;"><span id="MJXc-Node-24" class="mjx-mtd" style="padding: 0px; text-align: left; width: 11.835em;"><span id="MJXc-Node-25" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-26" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">1</span></span><span id="MJXc-Node-27" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">&nbsp;if customer&nbsp;</span></span><span id="MJXc-Node-28" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">n</span></span><span id="MJXc-Node-29" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">&nbsp;will churn</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-30" class="mjx-mtr" style="height: 1.1em;"><span id="MJXc-Node-31" class="mjx-mtd" style="padding: 0.1em 0px 0px; text-align: left;"><span id="MJXc-Node-32" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-33" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">0</span></span><span id="MJXc-Node-34" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">&nbsp;if customer&nbsp;</span></span><span id="MJXc-Node-35" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">n</span></span><span id="MJXc-Node-36" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">&nbsp;won't churn</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-37" class="mjx-mo" style="width: 0.12em;"></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msup><mi>y</mi><mi>n</mi></msup><mo>=</mo><mrow><mo>{</mo><mtable columnalign="left left" rowspacing=".2em" columnspacing="1em" displaystyle="false"><mtr><mtd><mn>1</mn><mtext>&nbsp;if customer&nbsp;</mtext><mi>n</mi><mtext>&nbsp;will churn</mtext></mtd></mtr><mtr><mtd><mn>0</mn><mtext>&nbsp;if customer&nbsp;</mtext><mi>n</mi><mtext>&nbsp;won't churn</mtext></mtd></mtr></mtable><mo fence="true" stretchy="true" symmetric="true"></mo></mrow></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-4">y^n=
\begin{cases}
1\text{ if customer } n\text{ will churn}\\
0\text{ if customer } n\text{ won't churn}
\end{cases}</script>

  <p>The <em>churn-rate</em> is the mean change in the number of churned customers. 
The machine learning model we want to build uses features <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-5-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-38" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-39" class="mjx-mrow"><span id="MJXc-Node-40" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-41" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">x</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-42" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">n</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>x</mi><mi>n</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-5">x^n</script> for customer <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-6-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-43" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-44" class="mjx-mrow"><span id="MJXc-Node-45" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">n</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-6">n</script> to estimate the probability of churning, i.e the churn score™.</p>
</blockquote>

<p>Reality rarely fits into this box. Even though we often know a churned customer when we see them,  operationalizing this fuzzy concept can be hard. The problem stems from some type of linguistical bug - our intuition around churn seems to be riddled with hidden temporal assumptions and engrained circular reasoning. As you dig into the details you discover an abyss of vagueness.</p>

<ul>
  <li>What does <strong><em>will</em></strong> mean? We all ‘churn’ at some point :(</li>
  <li>What does <strong><em>a customer</em></strong> mean? A customer at a given point in time? A subscription plan? A non-‘churned’ period of a given customer-id?</li>
  <li>What’s the shape of the feature vector? Fixed width with static features or aggregated over time implying different measurement errors? Isn’t it really time series for each customer?</li>
  <li>What does <strong><em>churn</em></strong> mean? Million dollar question</li>
  <li>You probably can’t know the current churn rate, you need your churn-model to predict/estimate it.</li>
</ul>

<p>After realizing this and snapping out of the dream, data scientists will often end up defining it by drawing some arbitrary line in the sand like ‘no purchase for 30 days’. This is nothing to be ashamed of. I’ll try to give you a few tricks that helps you speed up this modeling process. The first is to frame the problem in a good way.</p>

<h3 id="churn-prediction--non-event-prediction">Churn prediction = non-event prediction</h3>
<p>Don’t predict churn, predict non-churn. My philosophy is losely that <em>if something happens in the future</em> that can be used to define the customer as non-churned we can define this <em>something</em> as an <em>event</em>. If there’s an event happening in the future we can define the <em>time</em> to that event from any prior point in time. If a customer has a longer time to a future event that customer is <em>more churned</em>.</p>

<p>The raw data that we have to work with are a series of records for each customer. You can think of each customer as a timeline starting from when we first saw them until today. We can stack these timelines on top of eachother to get some overview on who had data when:</p>

<p><img src="./Focus on the objective · Egils blog_files/JT60TnL.png" alt="stacked_timelines.png"></p>

<p>Divide your dataset so that you have the <em>events</em> (like purchases or logins) that matters for your churn definition and <em>features</em> (clicks, purchases, logins etc) that can be used to predict them. Here’s a few examples of what the events and the features could be for an individual timeline:</p>

<p><img src="./Focus on the objective · Egils blog_files/pdpFqb8.gif" alt="intro_event_feature_pairs_v2.gif"></p>

<p>We want to use these features to sequentially predict the future using historic data:
<img src="./Focus on the objective · Egils blog_files/fD9iQJd.gif" alt="intro_sequential_prediction.gif"></p>

<p>The next trick is to define <strong>what</strong> you want to predict which can be done in multiple ways. I think the most natural thing is to predict the <strong>time to the next event</strong> <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-7-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-46" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-47" class="mjx-mrow"><span id="MJXc-Node-48" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-49" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.489em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-50" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>y</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-7">y_t</script> at each timestep <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-8-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-51" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-52" class="mjx-mrow"><span id="MJXc-Node-53" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-8">t</script>. I will call this <strong>TTE</strong> for short. We can visualize this as a kind of sawtooth-wave:</p>

<p><img src="./Focus on the objective · Egils blog_files/CjQoNFg.gif" alt="intro_tte_nofuzz.gif">
If some user has a longer time to the next purchase it’s reasonable to say that they are <em>more churned</em>. So is it as easy as point-estimating this wave? A regression problem? Nope.</p>

<p>If the user never purchases anything again <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-9-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x221E;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-54" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-55" class="mjx-mrow"><span id="MJXc-Node-56" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-57" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.489em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-58" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span><span id="MJXc-Node-59" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.223em; padding-bottom: 0.356em;">→</span></span><span id="MJXc-Node-60" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.135em; padding-bottom: 0.356em;">∞</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>y</mi><mi>t</mi></msub><mo stretchy="false">→</mo><mi mathvariant="normal">∞</mi></math></span></span><script type="math/tex" id="MathJax-Element-9">y_t\to\infty</script>. Problem is that we need to wait forever to know that this was the case. This leads us to the fundamental problem of this type of data: <strong>censoring</strong>.</p>

<h3 id="censored-data">Censored data</h3>
<p>We don’t know how old we’ll get but we know that we’ll get at least as old as our current age. Age is an example of a <strong>censored datapoint</strong> and yours is probably written down on some actuarys spreadsheet somewhere. If you haven’t heard about this useful concept before it’s probably because the frequentist statisticians that work on it only likes to explain it using particular jargon in impenetrable 1000-page books on how it’s used with a particular model to a particular dataset for some particular type of cancer. I’ll try to be more general.</p>

<p>In our world we only recoreded event-data from the <strong>observed past</strong> i.e from when we first saw the customer up until now (vertical zigzag in gif). This means that after the last seen event we don’t have data for the actual time to the next (unseen) event. What we have is a lower bound that we can use for training, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-10-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-61" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-62" class="mjx-mrow"><span id="MJXc-Node-63" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-64" class="mjx-texatom"><span id="MJXc-Node-65" class="mjx-mrow"><span id="MJXc-Node-66" class="mjx-munderover"><span class="mjx-stack"><span class="mjx-over" style="height: 0.213em; padding-bottom: 0.06em; padding-left: 0.083em;"><span id="MJXc-Node-68" class="mjx-mo" style="vertical-align: top;"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.312em;">^</span></span></span><span class="mjx-op"><span id="MJXc-Node-67" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.489em; padding-right: 0.006em;">y</span></span></span></span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.375em; padding-right: 0.071em;"><span id="MJXc-Node-69" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span><span id="MJXc-Node-70" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.356em; padding-bottom: 0.489em;">≤</span></span><span id="MJXc-Node-71" class="mjx-msubsup MJXc-space3"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-72" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.489em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-73" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mi>t</mi></msub><mo>≤</mo><msub><mi>y</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-10">\hat{y}_t\leq y_t</script>. This partial observation is called <strong>right censored data</strong> and is shown in dotted red:</p>

<p><img src="./Focus on the objective · Egils blog_files/hkpM09J.gif" alt="intro_tte.gif"></p>

<p>A censored observation&nbsp;<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-11-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-74" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-75" class="mjx-mrow"><span id="MJXc-Node-76" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-77" class="mjx-texatom"><span id="MJXc-Node-78" class="mjx-mrow"><span id="MJXc-Node-79" class="mjx-munderover"><span class="mjx-stack"><span class="mjx-over" style="height: 0.153em; padding-bottom: 0.06em; padding-left: 0.083em;"><span id="MJXc-Node-81" class="mjx-mo" style="vertical-align: top;"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.046em; padding-bottom: 0.312em;">~</span></span></span><span class="mjx-op"><span id="MJXc-Node-80" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.489em; padding-right: 0.006em;">y</span></span></span></span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.375em; padding-right: 0.071em;"><span id="MJXc-Node-82" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">~</mo></mover></mrow><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-11">\tilde{y}_t</script> is interpreted as <em>“at time <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-12-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-83" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-84" class="mjx-mrow"><span id="MJXc-Node-85" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-12">t</script> there was at least <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-13-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-86" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-87" class="mjx-mrow"><span id="MJXc-Node-88" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-89" class="mjx-texatom"><span id="MJXc-Node-90" class="mjx-mrow"><span id="MJXc-Node-91" class="mjx-munderover"><span class="mjx-stack"><span class="mjx-over" style="height: 0.213em; padding-bottom: 0.06em; padding-left: 0.083em;"><span id="MJXc-Node-93" class="mjx-mo" style="vertical-align: top;"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.312em;">^</span></span></span><span class="mjx-op"><span id="MJXc-Node-92" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.489em; padding-right: 0.006em;">y</span></span></span></span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.375em; padding-right: 0.071em;"><span id="MJXc-Node-94" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-13">\hat{y}_t</script> timesteps until an event”</em>. How can we use this data for training models?</p>

<h2 id="models-for-censored-data">Models for censored data</h2>
<p>The hacky way that i bet 99.9% of all churn-models use is to do a binary workaround using fixed windows. I call this the <strong>sliding box model</strong>:</p>

<h3 id="sliding-box-model">Sliding box model</h3>
<p>Instead of trying to predict the TTE directly we predict whether an event happened within a preset timeframe <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-14-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-95" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-96" class="mjx-mrow"><span id="MJXc-Node-97" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.312em; padding-right: 0.08em;">τ</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>τ</mi></math></span></span><script type="math/tex" id="MathJax-Element-14">\tau</script>. We define the observed target value <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-15-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-98" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-99" class="mjx-mrow"><span id="MJXc-Node-100" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-101" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.268em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-102" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>b</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-15">b_t</script> at timestep <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-16-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-103" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-104" class="mjx-mrow"><span id="MJXc-Node-105" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-16">t</script> as</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-17-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;{&lt;/mo&gt;&lt;mtable columnalign=&quot;left left&quot; rowspacing=&quot;.2em&quot; columnspacing=&quot;1em&quot; displaystyle=&quot;false&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mtext&gt;if event in&amp;#xA0;&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mtext&gt;if no event in&amp;#xA0;&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mtext&gt;unknown&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mtext&gt;else&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo fence=&quot;true&quot; stretchy=&quot;true&quot; symmetric=&quot;true&quot;&gt;&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-106" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-107" class="mjx-mrow"><span id="MJXc-Node-108" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-109" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.268em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-110" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span><span id="MJXc-Node-111" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.091em; padding-bottom: 0.312em;">=</span></span><span id="MJXc-Node-112" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-113" class="mjx-mo" style="vertical-align: -0.601em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.666em; padding-bottom: 0.268em; margin-bottom: -0.119em;">⎧</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.931em; padding-bottom: 0.931em;">⎨</span><span class="mjx-char MJXc-TeX-size4-R" style="margin-top: -0.338em; padding-bottom: 1.197em;">⎩</span></span></span><span id="MJXc-Node-114" class="mjx-mtable" style="vertical-align: -1.525em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-115" class="mjx-mtr" style="height: 1.175em;"><span id="MJXc-Node-116" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; text-align: left; width: 3.974em;"><span id="MJXc-Node-117" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-118" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-119" class="mjx-mtd" style="padding: 0px 0.5em; text-align: left; width: 5.835em;"><span id="MJXc-Node-120" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-121" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">if event in&nbsp;</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-122" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; text-align: left; width: 3.573em;"><span id="MJXc-Node-123" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-124" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">[</span></span><span id="MJXc-Node-125" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span><span id="MJXc-Node-126" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.175em; padding-bottom: 0.533em;">,</span></span><span id="MJXc-Node-127" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span><span id="MJXc-Node-128" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.312em; padding-bottom: 0.445em;">+</span></span><span id="MJXc-Node-129" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.312em; padding-right: 0.08em;">τ</span></span><span id="MJXc-Node-130" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">)</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-131" class="mjx-mtr" style="height: 1.275em;"><span id="MJXc-Node-132" class="mjx-mtd" style="padding: 0.1em 0.5em 0px 0px; text-align: left;"><span id="MJXc-Node-133" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-134" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-135" class="mjx-mtd" style="padding: 0.1em 0.5em 0px; text-align: left;"><span id="MJXc-Node-136" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-137" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">if no event in&nbsp;</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-138" class="mjx-mtd" style="padding: 0.1em 0px 0px 0.5em; text-align: left;"><span id="MJXc-Node-139" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-140" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">[</span></span><span id="MJXc-Node-141" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span><span id="MJXc-Node-142" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.175em; padding-bottom: 0.533em;">,</span></span><span id="MJXc-Node-143" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span><span id="MJXc-Node-144" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.312em; padding-bottom: 0.445em;">+</span></span><span id="MJXc-Node-145" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.312em; padding-right: 0.08em;">τ</span></span><span id="MJXc-Node-146" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">)</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-147" class="mjx-mtr" style="height: 1.1em;"><span id="MJXc-Node-148" class="mjx-mtd" style="padding: 0.1em 0.5em 0px 0px; text-align: left;"><span id="MJXc-Node-149" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-150" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">unknown</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-151" class="mjx-mtd" style="padding: 0.1em 0.5em 0px; text-align: left;"><span id="MJXc-Node-152" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-153" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">else</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-154" class="mjx-mtd" style="padding: 0.1em 0px 0px 0.5em; text-align: left;"><span id="MJXc-Node-155" class="mjx-mrow" style="margin-top: -0.2em;"><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-156" class="mjx-mo" style="width: 0.12em;"></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>b</mi><mi>t</mi></msub><mo>=</mo><mrow><mo>{</mo><mtable columnalign="left left" rowspacing=".2em" columnspacing="1em" displaystyle="false"><mtr><mtd><mn>1</mn></mtd><mtd><mtext>if event in&nbsp;</mtext></mtd><mtd><mo stretchy="false">[</mo><mi>t</mi><mo>,</mo><mi>t</mi><mo>+</mo><mi>τ</mi><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mtext>if no event in&nbsp;</mtext></mtd><mtd><mo stretchy="false">[</mo><mi>t</mi><mo>,</mo><mi>t</mi><mo>+</mo><mi>τ</mi><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><mtext>unknown</mtext></mtd><mtd><mtext>else</mtext></mtd><mtd></mtd></mtr></mtable><mo fence="true" stretchy="true" symmetric="true"></mo></mrow></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-17">% <![CDATA[
b_t = 
	\begin{cases}
		1& \text{if event in }    &[t,t+\tau) \\ 
		0& \text{if no event in } &[t,t+\tau) \\ 
		\text{unknown}& \text{else}&
	\end{cases} %]]></script>

<p>This can be seen as sliding a box in front of you and see if it covers any events:
<img src="./Focus on the objective · Egils blog_files/osjA1uZ.gif" alt="previous_work_sliding_box_gendata_tau_2.gif">
Here the unknowns/<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-18-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-157" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-158" class="mjx-mrow"><span id="MJXc-Node-159" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.268em; padding-right: 0.085em;">N</span></span><span id="MJXc-Node-160" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.268em;">A</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi><mi>A</mi></math></span></span><script type="math/tex" id="MathJax-Element-18">NA</script>’s appear in the last <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-19-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-161" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-162" class="mjx-mrow"><span id="MJXc-Node-163" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.312em; padding-right: 0.08em;">τ</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>τ</mi></math></span></span><script type="math/tex" id="MathJax-Element-19">\tau</script> steps of the observations when there’s no events (shown as blank in plot).</p>

<p>To construct a probabilistic objective function, think of the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-20-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-164" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-165" class="mjx-mrow"><span id="MJXc-Node-166" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-167" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.268em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-168" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>b</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-20">b_t</script>’s as independently drawn from a Bernoulli distribution that has a time varying parameter <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-21-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-169" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-170" class="mjx-mrow"><span id="MJXc-Node-171" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-172" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.268em;">θ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-173" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>θ</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-21">\theta_t</script> denoting the probability of event within <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-22-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-174" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-175" class="mjx-mrow"><span id="MJXc-Node-176" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.312em; padding-right: 0.08em;">τ</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>τ</mi></math></span></span><script type="math/tex" id="MathJax-Element-22">\tau</script> time from timestep <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-23-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-177" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-178" class="mjx-mrow"><span id="MJXc-Node-179" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-23">t</script>:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-24-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;mtext&gt;Bernoulli&lt;/mtext&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-180" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-181" class="mjx-mrow"><span id="MJXc-Node-182" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-183" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.268em;">B</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-184" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span><span id="MJXc-Node-185" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.091em; padding-bottom: 0.312em;">∼</span></span><span id="MJXc-Node-186" class="mjx-mtext MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">Bernoulli</span></span><span id="MJXc-Node-187" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">(</span></span><span id="MJXc-Node-188" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-189" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.268em;">θ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-190" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span><span id="MJXc-Node-191" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">)</span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>B</mi><mi>t</mi></msub><mo>∼</mo><mtext>Bernoulli</mtext><mo stretchy="false">(</mo><msub><mi>θ</mi><mi>t</mi></msub><mo stretchy="false">)</mo></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-24">B_t \sim \text{Bernoulli}(\theta_t)</script>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-25-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;&gt;Pr&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-192" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-193" class="mjx-mrow"><span id="MJXc-Node-194" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">Pr</span></span><span id="MJXc-Node-195" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">(</span></span><span id="MJXc-Node-196" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-197" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.268em;">B</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-198" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span><span id="MJXc-Node-199" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.091em; padding-bottom: 0.312em;">=</span></span><span id="MJXc-Node-200" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-201" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.268em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-202" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span><span id="MJXc-Node-203" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">)</span></span><span id="MJXc-Node-204" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.091em; padding-bottom: 0.312em;">=</span></span><span id="MJXc-Node-205" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-206" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.268em;">θ</span></span></span><span class="mjx-stack" style="vertical-align: -0.287em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-208" class="mjx-texatom" style=""><span id="MJXc-Node-209" class="mjx-mrow"><span id="MJXc-Node-210" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-211" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.268em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-212" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-207" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span></span><span id="MJXc-Node-213" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.002em; padding-bottom: 0.312em;">⋅</span></span><span id="MJXc-Node-214" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">(</span></span><span id="MJXc-Node-215" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">1</span></span><span id="MJXc-Node-216" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.312em; padding-bottom: 0.445em;">−</span></span><span id="MJXc-Node-217" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-218" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.268em;">θ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-219" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span><span id="MJXc-Node-220" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-221" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">)</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-222" class="mjx-texatom" style=""><span id="MJXc-Node-223" class="mjx-mrow"><span id="MJXc-Node-224" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">1</span></span><span id="MJXc-Node-225" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.312em; padding-bottom: 0.445em;">−</span></span><span id="MJXc-Node-226" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-227" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.268em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-228" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mo movablelimits="true" form="prefix">Pr</mo><mo stretchy="false">(</mo><msub><mi>B</mi><mi>t</mi></msub><mo>=</mo><msub><mi>b</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo>=</mo><msubsup><mi>θ</mi><mi>t</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>b</mi><mi>t</mi></msub></mrow></msubsup><mo>⋅</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mi>θ</mi><mi>t</mi></msub><msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mn>1</mn><mo>−</mo><msub><mi>b</mi><mi>t</mi></msub></mrow></msup></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-25">\Pr(B_t=b_t) = \theta_t^{b_t}\cdot(1-\theta_t)^{1-b_t}</script>

<p>Set <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-26-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-229" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-230" class="mjx-mrow"><span id="MJXc-Node-231" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-232" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.268em;">θ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-233" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>θ</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-26">\theta_t</script> as some machine learning model <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-27-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-234" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-235" class="mjx-mrow"><span id="MJXc-Node-236" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.489em; padding-right: 0.003em;">g</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi></math></span></span><script type="math/tex" id="MathJax-Element-27">g</script> taking data <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-28-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-237" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-238" class="mjx-mrow"><span id="MJXc-Node-239" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-240" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-241" class="mjx-texatom" style=""><span id="MJXc-Node-242" class="mjx-mrow"><span id="MJXc-Node-243" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">0</span></span><span id="MJXc-Node-244" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.135em; padding-bottom: 0.356em;">:</span></span><span id="MJXc-Node-245" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mn>0</mn><mo>:</mo><mi>t</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-28">x_{0:t}</script> available at time <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-29-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-246" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-247" class="mjx-mrow"><span id="MJXc-Node-248" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-249" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.268em;">θ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-250" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span><span id="MJXc-Node-251" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.091em; padding-bottom: 0.312em;">=</span></span><span id="MJXc-Node-252" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.489em; padding-right: 0.003em;">g</span></span><span id="MJXc-Node-253" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">(</span></span><span id="MJXc-Node-254" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-255" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-256" class="mjx-texatom" style=""><span id="MJXc-Node-257" class="mjx-mrow"><span id="MJXc-Node-258" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">0</span></span><span id="MJXc-Node-259" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.135em; padding-bottom: 0.356em;">:</span></span><span id="MJXc-Node-260" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span></span></span><span id="MJXc-Node-261" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>θ</mi><mi>t</mi></msub><mo>=</mo><mi>g</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mn>0</mn><mo>:</mo><mi>t</mi></mrow></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-29">\theta_t=g(x_{0:t})</script>. The objective function then becomes:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-30-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;munder&gt;&lt;mtext&gt;maximize&lt;/mtext&gt;&lt;mstyle scriptlevel=&quot;1&quot;&gt;&lt;mtable rowspacing=&quot;0.1em&quot; columnspacing=&quot;0em&quot; displaystyle=&quot;false&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/mstyle&gt;&lt;/munder&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;fraktur&quot;&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;:=&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-262" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-263" class="mjx-mrow"><span id="MJXc-Node-264" class="mjx-mtable" style="vertical-align: -0.707em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-265" class="mjx-mtr" style="height: 1.913em;"><span id="MJXc-Node-266" class="mjx-mtd" style="padding: 0px; text-align: right; width: 19.258em;"><span id="MJXc-Node-267" class="mjx-mrow"><span id="MJXc-Node-268" class="mjx-munder"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-op"><span id="MJXc-Node-269" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">maximize</span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 80%; padding-top: 0.208em; padding-bottom: 0.125em; padding-left: 2.269em;"><span id="MJXc-Node-270" class="mjx-mstyle" style=""><span id="MJXc-Node-271" class="mjx-mrow" style="font-size: 88.4%;"><span id="MJXc-Node-272" class="mjx-mtable" style="vertical-align: -0.099em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-273" class="mjx-mtr" style="height: 0.697em;"><span id="MJXc-Node-274" class="mjx-mtd" style="padding: 0px; width: 0.48em;"><span id="MJXc-Node-275" class="mjx-mrow" style="margin-top: -0.533em;"><span id="MJXc-Node-276" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.489em; padding-right: 0.003em;">g</span></span><span class="mjx-strut"></span></span></span></span></span></span></span></span></span></span></span></span><span id="MJXc-Node-277" class="mjx-mspace" style="width: 0.167em; height: 0px;"></span><span id="MJXc-Node-278" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.533em;">log</span></span><span id="MJXc-Node-279" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-280" class="mjx-mrow"><span id="MJXc-Node-281" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">(</span></span><span id="MJXc-Node-282" class="mjx-mrow"><span id="MJXc-Node-283" class="mjx-texatom"><span id="MJXc-Node-284" class="mjx-mrow"><span id="MJXc-Node-285" class="mjx-mi"><span class="mjx-char MJXc-TeX-frak-R" style="padding-top: 0.445em; padding-bottom: 0.312em;">L</span></span></span></span><span id="MJXc-Node-286" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">(</span></span><span id="MJXc-Node-287" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-288" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.268em;">θ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-289" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span><span id="MJXc-Node-290" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">)</span></span></span><span id="MJXc-Node-291" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">)</span></span></span><span id="MJXc-Node-292" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.091em; padding-bottom: 0.356em;">:<span class="mjx-charbox MJXc-TeX-main-R" style="padding-bottom: 0.314em;">=</span></span></span><span id="MJXc-Node-293" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.533em;">log</span></span><span id="MJXc-Node-294" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-295" class="mjx-mrow"><span id="MJXc-Node-296" class="mjx-mo"><span class="mjx-char MJXc-TeX-size2-R" style="padding-top: 0.931em; padding-bottom: 0.931em;">(</span></span><span id="MJXc-Node-297" class="mjx-mrow"><span id="MJXc-Node-298" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-299" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.268em;">θ</span></span></span><span class="mjx-stack" style="vertical-align: -0.287em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-301" class="mjx-texatom" style=""><span id="MJXc-Node-302" class="mjx-mrow"><span id="MJXc-Node-303" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-304" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.268em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-305" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-300" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span></span><span id="MJXc-Node-306" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.002em; padding-bottom: 0.312em;">⋅</span></span><span id="MJXc-Node-307" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">(</span></span><span id="MJXc-Node-308" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">1</span></span><span id="MJXc-Node-309" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.312em; padding-bottom: 0.445em;">−</span></span><span id="MJXc-Node-310" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-311" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.268em;">θ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-312" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span><span id="MJXc-Node-313" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-314" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">)</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-315" class="mjx-texatom" style=""><span id="MJXc-Node-316" class="mjx-mrow"><span id="MJXc-Node-317" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">1</span></span><span id="MJXc-Node-318" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.312em; padding-bottom: 0.445em;">−</span></span><span id="MJXc-Node-319" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-320" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.268em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-321" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span></span></span></span></span></span><span id="MJXc-Node-322" class="mjx-mo"><span class="mjx-char MJXc-TeX-size2-R" style="padding-top: 0.931em; padding-bottom: 0.931em;">)</span></span></span><span class="mjx-strut"></span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><munder><mtext>maximize</mtext><mstyle scriptlevel="1"><mtable rowspacing="0.1em" columnspacing="0em" displaystyle="false"><mtr><mtd><mi>g</mi></mtd></mtr></mtable></mstyle></munder><mspace width="thinmathspace"></mspace><mi>log</mi><mo>⁡</mo><mrow><mo>(</mo><mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="fraktur">L</mi></mrow><mo stretchy="false">(</mo><msub><mi>θ</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow><mo>)</mo></mrow><mo>:=</mo><mi>log</mi><mo>⁡</mo><mrow><mo>(</mo><mrow><msubsup><mi>θ</mi><mi>t</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>b</mi><mi>t</mi></msub></mrow></msubsup><mo>⋅</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mi>θ</mi><mi>t</mi></msub><msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mn>1</mn><mo>−</mo><msub><mi>b</mi><mi>t</mi></msub></mrow></msup></mrow><mo>)</mo></mrow></mtd></mtr></mtable></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-30">\begin{align*}
	\underset{\substack{g}}{\text{maximize}}\, 
\log\left(\mathfrak{L}(\theta_t)\right) : = \log\left(\theta_t^{b_t}\cdot(1-\theta_t)^{1-b_t}
\right)
\end{align*}</script>

<p>Predicting with the model can be visualized as letting the box-height be the predicted probability <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-31-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-323" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-324" class="mjx-mrow"><span id="MJXc-Node-325" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-326" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.268em;">θ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-327" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>θ</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-31">\theta_t</script> of event in box:</p>

<p><img src="./Focus on the objective · Egils blog_files/eUlGAVZ.gif" alt="previous_work_sliding_box_pred_tau_2.gif"></p>

<h4 id="use-as-a-churn-model">Use as a churn-model</h4>
<p>There’s some obvious benefits of this model.</p>

<ul>
  <li>Simplicity and explicity. It’s pretty easy to explain how it works.</li>
  <li>Flexibility. We can use any binary prediction algorithm. Think Xgboost or Random Forests or char-level RNNs.</li>
</ul>

<p>If you’ve built one you also know the downsides:</p>

<ul>
  <li>Your predictions are not very informative.</li>
</ul>

<p>Is a predicted probability of say ‘30 days without event’ really nuanced enough to be actionable? Does it fit all your customers? Instead of binary you could predict multiple timeintervals ahead but that leads to more hyperparameters hence more hacks.
In any case you probably want <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-32-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-328" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-329" class="mjx-mrow"><span id="MJXc-Node-330" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.312em; padding-right: 0.08em;">τ</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>τ</mi></math></span></span><script type="math/tex" id="MathJax-Element-32">\tau</script> to be as big as possible since you want to predict the <em>lack</em> of events (churn) in a foreseable future. Problem with that is that:</p>

<ul>
  <li>We can’t use the last <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-33-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-331" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-332" class="mjx-mrow"><span id="MJXc-Node-333" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.312em; padding-right: 0.08em;">τ</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>τ</mi></math></span></span><script type="math/tex" id="MathJax-Element-33">\tau</script> timesteps for training</li>
</ul>

<p>We can observe <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-34-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-334" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-335" class="mjx-mrow"><span id="MJXc-Node-336" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-337" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.268em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-338" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span><span id="MJXc-Node-339" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.091em; padding-bottom: 0.312em;">=</span></span><span id="MJXc-Node-340" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">1</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>b</mi><mi>t</mi></msub><mo>=</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-34">b_t=1</script> here if there are events but we can’t exclude that there’s no event just beyond the boundary. Unless we explicitly model this dropout we don’t know what sorts of biases and class-imbalances we introduce by using the positive observations. It’s therefore easiest and safest to drop all observations happening in the last <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-35-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-341" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-342" class="mjx-mrow"><span id="MJXc-Node-343" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.312em; padding-right: 0.08em;">τ</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>τ</mi></math></span></span><script type="math/tex" id="MathJax-Element-35">\tau</script> steps. This means that the higher <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-36-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-344" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-345" class="mjx-mrow"><span id="MJXc-Node-346" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.312em; padding-right: 0.08em;">τ</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>τ</mi></math></span></span><script type="math/tex" id="MathJax-Element-36">\tau</script> is, the less recent data we have to train on. 
Raising <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-37-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-347" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-348" class="mjx-mrow"><span id="MJXc-Node-349" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.312em; padding-right: 0.08em;">τ</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>τ</mi></math></span></span><script type="math/tex" id="MathJax-Element-37">\tau</script> also induce a kind of sparsity such as all targets are 1’s:</p>

<p><img src="./Focus on the objective · Egils blog_files/vDgwNNo.gif" alt="previous_work_sliding_box_gendata_tau_4.gif"></p>

<p>Giving very blunt signals for your model to train on. 
If <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-38-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-350" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-351" class="mjx-mrow"><span id="MJXc-Node-352" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.312em; padding-right: 0.08em;">τ</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>τ</mi></math></span></span><script type="math/tex" id="MathJax-Element-38">\tau</script> is too small the model output becomes meaningless. If <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-39-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-353" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-354" class="mjx-mrow"><span id="MJXc-Node-355" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.312em; padding-right: 0.08em;">τ</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>τ</mi></math></span></span><script type="math/tex" id="MathJax-Element-39">\tau</script> is too big we can’t train it. In summary, the sliding box model is</p>

<ul>
  <li>Hackish and horrible to work with</li>
</ul>

<p>The parameter <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-40-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-356" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-357" class="mjx-mrow"><span id="MJXc-Node-358" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.312em; padding-right: 0.08em;">τ</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>τ</mi></math></span></span><script type="math/tex" id="MathJax-Element-40">\tau</script> rigidly defines everything about your model. Changing <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-41-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-359" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-360" class="mjx-mrow"><span id="MJXc-Node-361" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.312em; padding-right: 0.08em;">τ</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>τ</mi></math></span></span><script type="math/tex" id="MathJax-Element-41">\tau</script> changes your data pipeline. It also changes the meaning of your predicted output and the model performance. Striking a balance is an awful and time-consuming iterative modeling loop.</p>

<p>In some settings binary targets/<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-42-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-362" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-363" class="mjx-mrow"><span id="MJXc-Node-364" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.312em; padding-right: 0.08em;">τ</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>τ</mi></math></span></span><script type="math/tex" id="MathJax-Element-42">\tau</script>’s are more easily defined and this model is great in certain applications. <a href="https://moz.com/devblog/deep-learning-for-customer-churn-prediction/">Moz developer blog</a> wrote a nice piece about how they successfully used RNNs in what looks like a similar framework.</p>

<h3 id="making-it-a-learning-to-rank-problem">Making it a <em>learning to rank</em>-problem.</h3>
<p>Instead of defining churn and predict it we can predict <em>who’s more churned than others</em>.
The usual application for a churn-model is to use the score to rank customers according to their riskset. Ranking is its own <a href="https://en.wikipedia.org/wiki/Learning_to_rank">machine learning topic</a>, and we can incorporate censored data in these models since it induces a partial order. If we know that there was at least say&nbsp;<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-43-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;7&lt;/mn&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-365" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-366" class="mjx-mrow"><span id="MJXc-Node-367" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">7</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>7</mn></math></span></span><script type="math/tex" id="MathJax-Element-43">7</script> days until an event, we can compare this to when we know that there was <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-44-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-368" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-369" class="mjx-mrow"><span id="MJXc-Node-370" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.356em; padding-bottom: 0.356em;">3</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>3</mn></math></span></span><script type="math/tex" id="MathJax-Element-44">3</script> days to an event since <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-45-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mn&gt;7&lt;/mn&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-371" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-372" class="mjx-mrow"><span id="MJXc-Node-373" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.356em; padding-bottom: 0.356em;">3</span></span><span id="MJXc-Node-374" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.268em; padding-bottom: 0.4em;">&lt;</span></span><span id="MJXc-Node-375" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">7</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>3</mn><mo>&lt;</mo><mn>7</mn></math></span></span><script type="math/tex" id="MathJax-Element-45">% <![CDATA[
3<7 %]]></script>. Noticing that <em>ranking</em> is really defined by all such pairwise comparisons we can formulate a binary target:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-46-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;{&lt;/mo&gt;&lt;mtable columnalign=&quot;left left&quot; rowspacing=&quot;.2em&quot; columnspacing=&quot;1em&quot; displaystyle=&quot;false&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mtext&gt;If&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mtext&gt;&amp;#xA0;and obs&amp;#xA0;&lt;/mtext&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mtext&gt;&amp;#xA0;not censored&lt;/mtext&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mtext&gt;If&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mtext&gt;&amp;#xA0;and both not censored&lt;/mtext&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mtext&gt;unknown&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mtext&gt;Else&lt;/mtext&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo fence=&quot;true&quot; stretchy=&quot;true&quot; symmetric=&quot;true&quot;&gt;&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-376" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-377" class="mjx-mrow"><span id="MJXc-Node-378" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-379" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">r</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-380" class="mjx-texatom" style=""><span id="MJXc-Node-381" class="mjx-mrow"><span id="MJXc-Node-382" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.268em;">i</span></span><span id="MJXc-Node-383" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.489em;">j</span></span></span></span></span></span><span id="MJXc-Node-384" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.091em; padding-bottom: 0.312em;">=</span></span><span id="MJXc-Node-385" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-386" class="mjx-mo" style="vertical-align: -0.753em;"><span class="mjx-delim-v"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.666em; padding-bottom: 0.268em;">⎧</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.083em; margin-bottom: 0.087em; margin-top: -0.137em;">⎪</span><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 0.931em; padding-bottom: 0.931em;">⎨</span><span class="mjx-char MJXc-TeX-size4-R" style="line-height: 0.083em; margin-bottom: 0.087em; margin-top: -0.137em;">⎪</span><span class="mjx-char MJXc-TeX-size4-R" style="margin-top: -0.219em; padding-bottom: 1.197em;">⎩</span></span></span><span id="MJXc-Node-387" class="mjx-mtable" style="vertical-align: -1.677em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-388" class="mjx-mtr" style="height: 1.327em;"><span id="MJXc-Node-389" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; text-align: left; width: 3.974em;"><span id="MJXc-Node-390" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-391" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-392" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; text-align: left; width: 13.854em;"><span id="MJXc-Node-393" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-394" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">If&nbsp;</span></span><span id="MJXc-Node-395" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-396" class="mjx-texatom"><span id="MJXc-Node-397" class="mjx-mrow"><span id="MJXc-Node-398" class="mjx-munderover"><span class="mjx-stack"><span class="mjx-over" style="height: 0.213em; padding-bottom: 0.06em; padding-left: 0.083em;"><span id="MJXc-Node-400" class="mjx-mo" style="vertical-align: top;"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.312em;">^</span></span></span><span class="mjx-op"><span id="MJXc-Node-399" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.489em; padding-right: 0.006em;">y</span></span></span></span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.375em; padding-right: 0.071em;"><span id="MJXc-Node-401" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.268em;">i</span></span></span></span><span id="MJXc-Node-402" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.356em; padding-bottom: 0.489em;">≤</span></span><span id="MJXc-Node-403" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-404" class="mjx-texatom"><span id="MJXc-Node-405" class="mjx-mrow"><span id="MJXc-Node-406" class="mjx-munderover"><span class="mjx-stack"><span class="mjx-over" style="height: 0.213em; padding-bottom: 0.06em; padding-left: 0.083em;"><span id="MJXc-Node-408" class="mjx-mo" style="vertical-align: top;"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.312em;">^</span></span></span><span class="mjx-op"><span id="MJXc-Node-407" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.489em; padding-right: 0.006em;">y</span></span></span></span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.375em; padding-right: 0.071em;"><span id="MJXc-Node-409" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.489em;">j</span></span></span></span><span id="MJXc-Node-410" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">&nbsp;and obs&nbsp;</span></span><span id="MJXc-Node-411" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.268em;">i</span></span><span id="MJXc-Node-412" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">&nbsp;not censored</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-413" class="mjx-mtr" style="height: 1.427em;"><span id="MJXc-Node-414" class="mjx-mtd" style="padding: 0.1em 0.5em 0px 0px; text-align: left;"><span id="MJXc-Node-415" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-416" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-417" class="mjx-mtd" style="padding: 0.1em 0px 0px 0.5em; text-align: left;"><span id="MJXc-Node-418" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-419" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">If&nbsp;</span></span><span id="MJXc-Node-420" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-421" class="mjx-texatom"><span id="MJXc-Node-422" class="mjx-mrow"><span id="MJXc-Node-423" class="mjx-munderover"><span class="mjx-stack"><span class="mjx-over" style="height: 0.213em; padding-bottom: 0.06em; padding-left: 0.083em;"><span id="MJXc-Node-425" class="mjx-mo" style="vertical-align: top;"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.312em;">^</span></span></span><span class="mjx-op"><span id="MJXc-Node-424" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.489em; padding-right: 0.006em;">y</span></span></span></span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.375em; padding-right: 0.071em;"><span id="MJXc-Node-426" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.268em;">i</span></span></span></span><span id="MJXc-Node-427" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.268em; padding-bottom: 0.4em;">&gt;</span></span><span id="MJXc-Node-428" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-429" class="mjx-texatom"><span id="MJXc-Node-430" class="mjx-mrow"><span id="MJXc-Node-431" class="mjx-munderover"><span class="mjx-stack"><span class="mjx-over" style="height: 0.213em; padding-bottom: 0.06em; padding-left: 0.083em;"><span id="MJXc-Node-433" class="mjx-mo" style="vertical-align: top;"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.312em;">^</span></span></span><span class="mjx-op"><span id="MJXc-Node-432" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.489em; padding-right: 0.006em;">y</span></span></span></span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.375em; padding-right: 0.071em;"><span id="MJXc-Node-434" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.489em;">j</span></span></span></span><span id="MJXc-Node-435" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">&nbsp;and both not censored</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-436" class="mjx-mtr" style="height: 1.1em;"><span id="MJXc-Node-437" class="mjx-mtd" style="padding: 0.1em 0.5em 0px 0px; text-align: left;"><span id="MJXc-Node-438" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-439" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">unknown</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-440" class="mjx-mtd" style="padding: 0.1em 0px 0px 0.5em; text-align: left;"><span id="MJXc-Node-441" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-442" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">Else</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-443" class="mjx-mo" style="width: 0.12em;"></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>r</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mrow><mo>{</mo><mtable columnalign="left left" rowspacing=".2em" columnspacing="1em" displaystyle="false"><mtr><mtd><mn>1</mn></mtd><mtd><mtext>If&nbsp;</mtext><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mi>i</mi></msub><mo>≤</mo><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mi>j</mi></msub><mtext>&nbsp;and obs&nbsp;</mtext><mi>i</mi><mtext>&nbsp;not censored</mtext></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mtext>If&nbsp;</mtext><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mi>i</mi></msub><mo>&gt;</mo><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mi>j</mi></msub><mtext>&nbsp;and both not censored</mtext></mtd></mtr><mtr><mtd><mtext>unknown</mtext></mtd><mtd><mtext>Else</mtext></mtd></mtr></mtable><mo fence="true" stretchy="true" symmetric="true"></mo></mrow></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-46">% <![CDATA[
r_{ij} = 
	\begin{cases}
		1&  \text{If }\hat{y}_i \leq \hat{y}_j \text{ and obs }i\text{ not censored}\\ 
		0&  \text{If }\hat{y}_i > \hat{y}_j    \text{ and both not censored} \\
		\text{unknown}& \text{Else}
	\end{cases} %]]></script>

<p>The machine-learning model <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-47-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-444" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-445" class="mjx-mrow"><span id="MJXc-Node-446" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.489em; padding-right: 0.003em;">g</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi></math></span></span><script type="math/tex" id="MathJax-Element-47">g</script> is then to use features from observation <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-48-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-447" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-448" class="mjx-mrow"><span id="MJXc-Node-449" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.268em;">i</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-48">i</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-49-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-450" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-451" class="mjx-mrow"><span id="MJXc-Node-452" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.489em;">j</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></span></span><script type="math/tex" id="MathJax-Element-49">j</script> to predict the ordering:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-50-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-453" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-454" class="mjx-mrow"><span id="MJXc-Node-455" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-456" class="mjx-texatom"><span id="MJXc-Node-457" class="mjx-mrow"><span id="MJXc-Node-458" class="mjx-munderover"><span class="mjx-stack"><span class="mjx-over" style="height: 0.213em; padding-bottom: 0.06em; padding-left: 0.031em;"><span id="MJXc-Node-460" class="mjx-mo" style="vertical-align: top;"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.312em;">^</span></span></span><span class="mjx-op"><span id="MJXc-Node-459" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">r</span></span></span></span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-461" class="mjx-texatom" style=""><span id="MJXc-Node-462" class="mjx-mrow"><span id="MJXc-Node-463" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.268em;">i</span></span><span id="MJXc-Node-464" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.489em;">j</span></span></span></span></span></span><span id="MJXc-Node-465" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.091em; padding-bottom: 0.312em;">=</span></span><span id="MJXc-Node-466" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.489em; padding-right: 0.003em;">g</span></span><span id="MJXc-Node-467" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">(</span></span><span id="MJXc-Node-468" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-469" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-470" class="mjx-texatom" style=""><span id="MJXc-Node-471" class="mjx-mrow"><span id="MJXc-Node-472" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">0</span></span><span id="MJXc-Node-473" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.135em; padding-bottom: 0.356em;">:</span></span><span id="MJXc-Node-474" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.268em;">i</span></span></span></span></span></span><span id="MJXc-Node-475" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.175em; padding-bottom: 0.533em;">,</span></span><span id="MJXc-Node-476" class="mjx-msubsup MJXc-space1"><span class="mjx-base"><span id="MJXc-Node-477" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-478" class="mjx-texatom" style=""><span id="MJXc-Node-479" class="mjx-mrow"><span id="MJXc-Node-480" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">0</span></span><span id="MJXc-Node-481" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.135em; padding-bottom: 0.356em;">:</span></span><span id="MJXc-Node-482" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.489em;">j</span></span></span></span></span></span><span id="MJXc-Node-483" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">)</span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>r</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mi>g</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mn>0</mn><mo>:</mo><mi>i</mi></mrow></msub><mo>,</mo><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mn>0</mn><mo>:</mo><mi>j</mi></mrow></msub><mo stretchy="false">)</mo></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-50">\hat{r}_{ij} = g(x_{0:i},x_{0:j})</script>

<p>As an example, if we don’t have any censored data and fix the target to be discrete <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-51-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;{&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;}&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-484" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-485" class="mjx-mrow"><span id="MJXc-Node-486" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-487" class="mjx-texatom"><span id="MJXc-Node-488" class="mjx-mrow"><span id="MJXc-Node-489" class="mjx-munderover"><span class="mjx-stack"><span class="mjx-over" style="height: 0.213em; padding-bottom: 0.06em; padding-left: 0.031em;"><span id="MJXc-Node-491" class="mjx-mo" style="vertical-align: top;"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.312em;">^</span></span></span><span class="mjx-op"><span id="MJXc-Node-490" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">r</span></span></span></span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-492" class="mjx-texatom" style=""><span id="MJXc-Node-493" class="mjx-mrow"><span id="MJXc-Node-494" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.268em;">i</span></span><span id="MJXc-Node-495" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.489em;">j</span></span></span></span></span></span><span id="MJXc-Node-496" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.268em; padding-bottom: 0.4em;">∈</span></span><span id="MJXc-Node-497" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">{</span></span><span id="MJXc-Node-498" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">0</span></span><span id="MJXc-Node-499" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.175em; padding-bottom: 0.533em;">,</span></span><span id="MJXc-Node-500" class="mjx-mn MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">1</span></span><span id="MJXc-Node-501" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">}</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>r</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub><mo>∈</mo><mo fence="false" stretchy="false">{</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo fence="false" stretchy="false">}</mo></math></span></span><script type="math/tex" id="MathJax-Element-51">\hat{r}_{ij} \in \{0,1\}</script> and minimize <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-52-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-502" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-503" class="mjx-mrow"><span id="MJXc-Node-504" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">∥</span></span><span id="MJXc-Node-505" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-506" class="mjx-texatom"><span id="MJXc-Node-507" class="mjx-mrow"><span id="MJXc-Node-508" class="mjx-munderover"><span class="mjx-stack"><span class="mjx-over" style="height: 0.213em; padding-bottom: 0.06em; padding-left: 0.031em;"><span id="MJXc-Node-510" class="mjx-mo" style="vertical-align: top;"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.312em;">^</span></span></span><span class="mjx-op"><span id="MJXc-Node-509" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">r</span></span></span></span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-511" class="mjx-texatom" style=""><span id="MJXc-Node-512" class="mjx-mrow"><span id="MJXc-Node-513" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.268em;">i</span></span><span id="MJXc-Node-514" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.489em;">j</span></span></span></span></span></span><span id="MJXc-Node-515" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.312em; padding-bottom: 0.445em;">−</span></span><span id="MJXc-Node-516" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-517" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">r</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-518" class="mjx-texatom" style=""><span id="MJXc-Node-519" class="mjx-mrow"><span id="MJXc-Node-520" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.268em;">i</span></span><span id="MJXc-Node-521" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.489em;">j</span></span></span></span></span></span><span id="MJXc-Node-522" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">∥</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">‖</mo><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>r</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub><mo>−</mo><msub><mi>r</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub><mo fence="false" stretchy="false">‖</mo></math></span></span><script type="math/tex" id="MathJax-Element-52">\|\hat{r}_{ij}-r_{ij}\|</script> one can show that this is identical to optimizing the <a href="https://en.wikipedia.org/wiki/Receiver_operating_characteristic#Area_under_the_curve">AUC</a>.  I haven’t thought of any probabilistic models for this but if we relax it to continuously be <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-53-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-523" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-524" class="mjx-mrow"><span id="MJXc-Node-525" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-526" class="mjx-texatom"><span id="MJXc-Node-527" class="mjx-mrow"><span id="MJXc-Node-528" class="mjx-munderover"><span class="mjx-stack"><span class="mjx-over" style="height: 0.213em; padding-bottom: 0.06em; padding-left: 0.031em;"><span id="MJXc-Node-530" class="mjx-mo" style="vertical-align: top;"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.312em;">^</span></span></span><span class="mjx-op"><span id="MJXc-Node-529" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">r</span></span></span></span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-531" class="mjx-texatom" style=""><span id="MJXc-Node-532" class="mjx-mrow"><span id="MJXc-Node-533" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.268em;">i</span></span><span id="MJXc-Node-534" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.489em;">j</span></span></span></span></span></span><span id="MJXc-Node-535" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.268em; padding-bottom: 0.4em;">∈</span></span><span id="MJXc-Node-536" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">[</span></span><span id="MJXc-Node-537" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">0</span></span><span id="MJXc-Node-538" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.175em; padding-bottom: 0.533em;">,</span></span><span id="MJXc-Node-539" class="mjx-mn MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">1</span></span><span id="MJXc-Node-540" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">]</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>r</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub><mo>∈</mo><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-53">\hat{r}_{ij} \in [0,1]</script> we could get some results from any binary prediction algorithm.</p>

<p>As the dataset are the pairwise combinations of all the observations the training dataset (<em>training time</em>) grows quadratically. We also have the problem of not actually being able to say whether an individual customer is predicted as churned or not, only whether they are predicted as more churned than someone else.</p>

<p>There’s some really cool current research on learning to rank and optimization for the AUC that deserves its own blogpost. I recommend <a href="http://wwwhome.cs.utwente.nl/~hiemstra/papers/ipm2015.pdf">this article of the year 2015</a> The fact that this is a cool and fairly unknown field is a problem in terms of easy it is to implement and communicate the models.</p>

<h2 id="what-we-want-in-a-churn-model">What we want in a churn-model</h2>

<p>Churn modeling is more of an art than a science. In the end we’ll have to draw some line in the sand to define what a churned customer is. When drawing this line it’s good to keep a few things in mind. I think the objective when defining ‘churn’ is to:</p>

<ul>
  <li>Minimize probability of resurrection
    <ul>
      <li>Permanence. Stakeholders will assume that a churned customer is in a permanent state and/or won’t bring in any future value.</li>
    </ul>
  </li>
  <li>Maximize the probability of detection
    <ul>
      <li>Measurability. Your churn-definition is useless if the reality corresponding to your churn-definition is neither measurable or predictable. Note that this is linked to your downstream ML-modeling strategy.</li>
    </ul>
  </li>
  <li>Maximize interpretability of your definition
    <ul>
      <li>A good &amp; safe churn-definition corresponds to what people assume that it means. A bug in natural language is that you can’t change this assumption so if you can’t model this concept, <strong>don’t call it churn</strong>. Call it something else like <em>active</em> vs <em>inactive</em> customers.</li>
    </ul>
  </li>
</ul>

<p>The last point is the most important one. One can argue that ‘churn’-modeling is something you should only be doing if you’re in a clear-cut subscription based service. Even then it might be hard. The Netflix-class action lawsuit, where shareholders felt mislead over reported churn-rates, showed that <a href="http://www.globenewswire.com/news-release/2004/08/10/314172/62086/en/Investor-Notice-Murray-Frank-Sailer-LLP-Announces-Shareholder-Lawsuit-Against-Netflix-Inc-NFLX.html">all stakeholders seems to be confused</a> about how to define churn. The court even dropped the case concluding that there’s no official definition of it.</p>

<p>With no clear way to do it you’ll have to figure out what works for you. We’ve seen that the big bottleneck (as always) is feature-engineering and a cumbersome modeling loop. To make it easier I think a good machine-learning model in this case can:</p>

<ol>
  <li>Work with recurrent events</li>
  <li>Can handle time varying covariates</li>
  <li>Can learn temporal patterns</li>
  <li>Handle sequences of varying length</li>
  <li>Learn with censored data</li>
  <li>Make flexible predictions</li>
</ol>

<p>To speed up the process.</p>

<p>We can cross out 1-4 by using RNNs as the machine-learning algorithm. I just think Neural Networks are less hacky than many other models as you can spend less time engineering features and more time testing your model. Recurrent neural networks for time series prediction are less hacky than non-temporal models because you don’t have to hand-engineer temporal features by using window functions such as ‘mean number of purchases last x days’. 
Regression-puritans will hang me for this, but I’m of the opinion that <strong>neural networks are not black box models</strong>. If you want insights, analyze the patterns your network learned, not the other way around.</p>

<p>The final points, 5-6 can be crossed of by choosing a smart objective function. Meet the WTTE-RNN:</p>

<h2 id="wtte-rnn">WTTE-RNN</h2>
<p>The recipe for this model is embarassingly simple.</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-54-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-541" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-542" class="mjx-mrow"><span id="MJXc-Node-543" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-544" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.489em; padding-right: 0.006em;">y</span></span></span><span class="mjx-stack" style="vertical-align: -0.287em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0.082em; padding-right: 0.071em;"><span id="MJXc-Node-546" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">n</span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-545" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>y</mi><mi>t</mi><mi>n</mi></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-54">y_t^n</script> is the TTE for user <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-55-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-547" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-548" class="mjx-mrow"><span id="MJXc-Node-549" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">n</span></span><span id="MJXc-Node-550" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.091em; padding-bottom: 0.312em;">=</span></span><span id="MJXc-Node-551" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">1</span></span><span id="MJXc-Node-552" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.175em; padding-bottom: 0.533em;">,</span></span><span id="MJXc-Node-553" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.175em; padding-bottom: 0.356em;">…</span></span><span id="MJXc-Node-554" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.175em; padding-bottom: 0.533em;">,</span></span><span id="MJXc-Node-555" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.268em; padding-right: 0.085em;">N</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi><mo>=</mo><mn>1</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>N</mi></math></span></span><script type="math/tex" id="MathJax-Element-55">n=1,\ldots,N</script> at timestep <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-56-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-556" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-557" class="mjx-mrow"><span id="MJXc-Node-558" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span><span id="MJXc-Node-559" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.091em; padding-bottom: 0.312em;">=</span></span><span id="MJXc-Node-560" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">0</span></span><span id="MJXc-Node-561" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.175em; padding-bottom: 0.533em;">,</span></span><span id="MJXc-Node-562" class="mjx-mn MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">1</span></span><span id="MJXc-Node-563" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.175em; padding-bottom: 0.533em;">,</span></span><span id="MJXc-Node-564" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.175em; padding-bottom: 0.356em;">…</span></span><span id="MJXc-Node-565" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.175em; padding-bottom: 0.533em;">,</span></span><span id="MJXc-Node-566" class="mjx-msubsup MJXc-space1"><span class="mjx-base" style="margin-right: -0.12em;"><span id="MJXc-Node-567" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.268em; padding-right: 0.12em;">T</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-568" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">n</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mo>=</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>T</mi><mi>n</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-56">t=0,1,\ldots,T_n</script></p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-57-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-569" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-570" class="mjx-mrow"><span id="MJXc-Node-571" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-572" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">x</span></span></span><span class="mjx-stack" style="vertical-align: -0.315em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-578" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">n</span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-573" class="mjx-texatom" style=""><span id="MJXc-Node-574" class="mjx-mrow"><span id="MJXc-Node-575" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">0</span></span><span id="MJXc-Node-576" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.135em; padding-bottom: 0.356em;">:</span></span><span id="MJXc-Node-577" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mn>0</mn><mo>:</mo><mi>t</mi></mrow><mi>n</mi></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-57">x^n_{0:t}</script> data up to time <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-58-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-579" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-580" class="mjx-mrow"><span id="MJXc-Node-581" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-58">t</script></p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-59-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-582" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-583" class="mjx-mrow"><span id="MJXc-Node-584" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-585" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">u</span></span></span><span class="mjx-stack" style="vertical-align: -0.287em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-587" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">n</span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-586" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>u</mi><mi>t</mi><mi>n</mi></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-59">u^n_t</script> indicating if datapoint is censored <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-60-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msubsup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-588" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-589" class="mjx-mrow"><span id="MJXc-Node-590" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-591" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">u</span></span></span><span class="mjx-stack" style="vertical-align: -0.287em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-593" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">n</span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-592" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span></span><span id="MJXc-Node-594" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.091em; padding-bottom: 0.312em;">=</span></span><span id="MJXc-Node-595" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">0</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>u</mi><mi>t</mi><mi>n</mi></msubsup><mo>=</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-60">u^n_t=0</script> or not <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-61-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msubsup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-596" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-597" class="mjx-mrow"><span id="MJXc-Node-598" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-599" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">u</span></span></span><span class="mjx-stack" style="vertical-align: -0.287em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-601" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">n</span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-600" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span></span><span id="MJXc-Node-602" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.091em; padding-bottom: 0.312em;">=</span></span><span id="MJXc-Node-603" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">1</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>u</mi><mi>t</mi><mi>n</mi></msubsup><mo>=</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-61">u^n_t=1</script></p>

<p>The special objective function comes from <a href="https://en.wikipedia.org/wiki/Survival_analysis">survival analysis</a>, the goal is to maximize</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-62-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;msubsup&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;&gt;Pr&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msubsup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msubsup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msubsup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;&gt;Pr&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msubsup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msubsup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-604" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-605" class="mjx-mrow"><span id="MJXc-Node-606" class="mjx-munderover"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-stack"><span class="mjx-over" style="font-size: 70.7%; padding-bottom: 0.258em; padding-top: 0.141em; padding-left: 0.577em;"><span id="MJXc-Node-613" class="mjx-texatom" style=""><span id="MJXc-Node-614" class="mjx-mrow"><span id="MJXc-Node-615" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.268em; padding-right: 0.085em;">N</span></span></span></span></span><span class="mjx-op"><span id="MJXc-Node-607" class="mjx-mo"><span class="mjx-char MJXc-TeX-size2-R" style="padding-top: 0.71em; padding-bottom: 0.71em;">∑</span></span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 0.082em;"><span id="MJXc-Node-608" class="mjx-texatom" style=""><span id="MJXc-Node-609" class="mjx-mrow"><span id="MJXc-Node-610" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">n</span></span><span id="MJXc-Node-611" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.091em; padding-bottom: 0.312em;">=</span></span><span id="MJXc-Node-612" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">1</span></span></span></span></span></span></span></span><span id="MJXc-Node-616" class="mjx-munderover MJXc-space1"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-stack"><span class="mjx-over" style="font-size: 70.7%; padding-bottom: 0.157em; padding-top: 0.141em; padding-left: 0.499em;"><span id="MJXc-Node-623" class="mjx-texatom" style=""><span id="MJXc-Node-624" class="mjx-mrow"><span id="MJXc-Node-625" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.12em;"><span id="MJXc-Node-626" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.268em; padding-right: 0.12em;">T</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-627" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">n</span></span></span></span></span></span></span><span class="mjx-op"><span id="MJXc-Node-617" class="mjx-mo"><span class="mjx-char MJXc-TeX-size2-R" style="padding-top: 0.71em; padding-bottom: 0.71em;">∑</span></span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 0.202em;"><span id="MJXc-Node-618" class="mjx-texatom" style=""><span id="MJXc-Node-619" class="mjx-mrow"><span id="MJXc-Node-620" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span><span id="MJXc-Node-621" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.091em; padding-bottom: 0.312em;">=</span></span><span id="MJXc-Node-622" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">0</span></span></span></span></span></span></span></span><span id="MJXc-Node-628" class="mjx-msubsup MJXc-space1"><span class="mjx-base"><span id="MJXc-Node-629" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">u</span></span></span><span class="mjx-stack" style="vertical-align: -0.287em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-631" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">n</span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-630" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span></span><span id="MJXc-Node-632" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.002em; padding-bottom: 0.312em;">⋅</span></span><span id="MJXc-Node-633" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.533em;">log</span></span><span id="MJXc-Node-634" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-635" class="mjx-mrow"><span id="MJXc-Node-636" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.622em; padding-bottom: 0.622em;">[</span></span><span id="MJXc-Node-637" class="mjx-mrow"><span id="MJXc-Node-638" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">Pr</span></span><span id="MJXc-Node-639" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">(</span></span><span id="MJXc-Node-640" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.182em;"><span id="MJXc-Node-641" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.268em; padding-right: 0.182em;">Y</span></span></span><span class="mjx-stack" style="vertical-align: -0.287em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0.405em; padding-right: 0.071em;"><span id="MJXc-Node-643" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">n</span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-642" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span></span><span id="MJXc-Node-644" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.091em; padding-bottom: 0.312em;">=</span></span><span id="MJXc-Node-645" class="mjx-msubsup MJXc-space3"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-646" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.489em; padding-right: 0.006em;">y</span></span></span><span class="mjx-stack" style="vertical-align: -0.287em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0.082em; padding-right: 0.071em;"><span id="MJXc-Node-648" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">n</span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-647" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span></span><span id="MJXc-Node-649" class="mjx-texatom"><span id="MJXc-Node-650" class="mjx-mrow"><span id="MJXc-Node-651" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">|</span></span></span></span><span id="MJXc-Node-652" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-653" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">x</span></span></span><span class="mjx-stack" style="vertical-align: -0.315em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-659" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">n</span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-654" class="mjx-texatom" style=""><span id="MJXc-Node-655" class="mjx-mrow"><span id="MJXc-Node-656" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">0</span></span><span id="MJXc-Node-657" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.135em; padding-bottom: 0.356em;">:</span></span><span id="MJXc-Node-658" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span></span></span></span><span id="MJXc-Node-660" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">)</span></span></span><span id="MJXc-Node-661" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.622em; padding-bottom: 0.622em;">]</span></span></span><span id="MJXc-Node-662" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.312em; padding-bottom: 0.445em;">+</span></span><span id="MJXc-Node-663" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">(</span></span><span id="MJXc-Node-664" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">1</span></span><span id="MJXc-Node-665" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.312em; padding-bottom: 0.445em;">−</span></span><span id="MJXc-Node-666" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-667" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">u</span></span></span><span class="mjx-stack" style="vertical-align: -0.287em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-669" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">n</span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-668" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span></span><span id="MJXc-Node-670" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">)</span></span><span id="MJXc-Node-671" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.002em; padding-bottom: 0.312em;">⋅</span></span><span id="MJXc-Node-672" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.533em;">log</span></span><span id="MJXc-Node-673" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-674" class="mjx-mrow"><span id="MJXc-Node-675" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.622em; padding-bottom: 0.622em;">[</span></span><span id="MJXc-Node-676" class="mjx-mrow"><span id="MJXc-Node-677" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">Pr</span></span><span id="MJXc-Node-678" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">(</span></span><span id="MJXc-Node-679" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.182em;"><span id="MJXc-Node-680" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.268em; padding-right: 0.182em;">Y</span></span></span><span class="mjx-stack" style="vertical-align: -0.287em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0.405em; padding-right: 0.071em;"><span id="MJXc-Node-682" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">n</span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-681" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span></span><span id="MJXc-Node-683" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.268em; padding-bottom: 0.4em;">&gt;</span></span><span id="MJXc-Node-684" class="mjx-msubsup MJXc-space3"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-685" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.489em; padding-right: 0.006em;">y</span></span></span><span class="mjx-stack" style="vertical-align: -0.287em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0.082em; padding-right: 0.071em;"><span id="MJXc-Node-687" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">n</span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-686" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span></span><span id="MJXc-Node-688" class="mjx-texatom"><span id="MJXc-Node-689" class="mjx-mrow"><span id="MJXc-Node-690" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">|</span></span></span></span><span id="MJXc-Node-691" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-692" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">x</span></span></span><span class="mjx-stack" style="vertical-align: -0.315em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-698" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">n</span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-693" class="mjx-texatom" style=""><span id="MJXc-Node-694" class="mjx-mrow"><span id="MJXc-Node-695" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">0</span></span><span id="MJXc-Node-696" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.135em; padding-bottom: 0.356em;">:</span></span><span id="MJXc-Node-697" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span></span></span></span><span id="MJXc-Node-699" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">)</span></span></span><span id="MJXc-Node-700" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.622em; padding-bottom: 0.622em;">]</span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>N</mi></mrow></munderover><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><msub><mi>T</mi><mi>n</mi></msub></mrow></munderover><msubsup><mi>u</mi><mi>t</mi><mi>n</mi></msubsup><mo>⋅</mo><mi>log</mi><mo>⁡</mo><mrow><mo>[</mo><mrow><mo movablelimits="true" form="prefix">Pr</mo><mo stretchy="false">(</mo><msubsup><mi>Y</mi><mi>t</mi><mi>n</mi></msubsup><mo>=</mo><msubsup><mi>y</mi><mi>t</mi><mi>n</mi></msubsup><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msubsup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mn>0</mn><mo>:</mo><mi>t</mi></mrow><mi>n</mi></msubsup><mo stretchy="false">)</mo></mrow><mo>]</mo></mrow><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msubsup><mi>u</mi><mi>t</mi><mi>n</mi></msubsup><mo stretchy="false">)</mo><mo>⋅</mo><mi>log</mi><mo>⁡</mo><mrow><mo>[</mo><mrow><mo movablelimits="true" form="prefix">Pr</mo><mo stretchy="false">(</mo><msubsup><mi>Y</mi><mi>t</mi><mi>n</mi></msubsup><mo>&gt;</mo><msubsup><mi>y</mi><mi>t</mi><mi>n</mi></msubsup><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msubsup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mn>0</mn><mo>:</mo><mi>t</mi></mrow><mi>n</mi></msubsup><mo stretchy="false">)</mo></mrow><mo>]</mo></mrow></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-62">\sum_{n=1}^{N}\sum_{t=0}^{T_n} u_t^n\cdot\log\left[ \Pr(Y_t^n = y^n_t | x^n_{0:t}) \right]+(1-u_t^n)\cdot\log\left[ \Pr(Y_t^n > y^n_t | x^n_{0:t}) \right]</script>

<p>Where we imagined that the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-63-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-701" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-702" class="mjx-mrow"><span id="MJXc-Node-703" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.182em;"><span id="MJXc-Node-704" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.268em; padding-right: 0.182em;">Y</span></span></span><span class="mjx-stack" style="vertical-align: -0.287em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0.405em; padding-right: 0.071em;"><span id="MJXc-Node-706" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">n</span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-705" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>Y</mi><mi>t</mi><mi>n</mi></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-63">Y_t^n</script> is a random experiment who’s distribution we want to model. We make this into a machine learning problem by:</p>

<ol>
  <li>Assuming that the time to event <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-64-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-707" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-708" class="mjx-mrow"><span id="MJXc-Node-709" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.182em;"><span id="MJXc-Node-710" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.268em; padding-right: 0.182em;">Y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-711" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>Y</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-64">Y_t</script> in each step follows some distribution governed by some parameter set <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-65-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-712" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-713" class="mjx-mrow"><span id="MJXc-Node-714" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-715" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.268em;">θ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-716" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>θ</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-65">\theta_t</script> s.t <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-66-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-717" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-718" class="mjx-mrow"><span id="MJXc-Node-719" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.268em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-720" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">r</span></span><span id="MJXc-Node-721" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">(</span></span><span id="MJXc-Node-722" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.182em;"><span id="MJXc-Node-723" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.268em; padding-right: 0.182em;">Y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-724" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span><span id="MJXc-Node-725" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.356em; padding-bottom: 0.489em;">≤</span></span><span id="MJXc-Node-726" class="mjx-msubsup MJXc-space3"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-727" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.489em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-728" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span><span id="MJXc-Node-729" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">∥</span></span><span id="MJXc-Node-730" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-731" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.268em;">θ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-732" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span><span id="MJXc-Node-733" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mi>r</mi><mo stretchy="false">(</mo><msub><mi>Y</mi><mi>t</mi></msub><mo>≤</mo><msub><mi>y</mi><mi>t</mi></msub><mo fence="false" stretchy="false">‖</mo><msub><mi>θ</mi><mi>t</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-66">Pr(Y_t\leq y_t\|\theta_t)</script></li>
  <li>Let <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-67-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-734" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-735" class="mjx-mrow"><span id="MJXc-Node-736" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-737" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.268em;">θ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-738" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>θ</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-67">\theta_t</script> be the output of some machine learning model (like an RNN) taking feature history at timestep <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-68-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-739" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-740" class="mjx-mrow"><span id="MJXc-Node-741" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-68">t</script> as input, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-69-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-742" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-743" class="mjx-mrow"><span id="MJXc-Node-744" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-745" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.268em;">θ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-746" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span><span id="MJXc-Node-747" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.091em; padding-bottom: 0.312em;">=</span></span><span id="MJXc-Node-748" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.489em; padding-right: 0.003em;">g</span></span><span id="MJXc-Node-749" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">(</span></span><span id="MJXc-Node-750" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-751" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-752" class="mjx-texatom" style=""><span id="MJXc-Node-753" class="mjx-mrow"><span id="MJXc-Node-754" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">0</span></span><span id="MJXc-Node-755" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.135em; padding-bottom: 0.356em;">:</span></span><span id="MJXc-Node-756" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span></span></span><span id="MJXc-Node-757" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>θ</mi><mi>t</mi></msub><mo>=</mo><mi>g</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mn>0</mn><mo>:</mo><mi>t</mi></mrow></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-69">\theta_t = g(x_{0:t})</script></li>
  <li>Train the machine learning model using the special log-likelihood loss for censored data as above.</li>
  <li>In each step you can now predict the <em>distribution</em> over the time to the next event</li>
</ol>

<p>What I call the WTTE-RNN is when we</p>

<ul>
  <li>Assume <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-70-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-758" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-759" class="mjx-mrow"><span id="MJXc-Node-760" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.268em; padding-right: 0.182em;">Y</span></span><span id="MJXc-Node-761" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.091em; padding-bottom: 0.312em;">∼</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Y</mi><mo>∼</mo></math></span></span><script type="math/tex" id="MathJax-Element-70">Y\sim</script>Weibull with parameters <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-71-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="font-size: 113%; position: relative;"><span id="MJXc-Node-762" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-763" class="mjx-mrow"><span id="MJXc-Node-764" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-765" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">α</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-766" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>α</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-71">\alpha_t</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-72-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="font-size: 113%; position: relative;"><span id="MJXc-Node-767" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-768" class="mjx-mrow"><span id="MJXc-Node-769" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.007em;"><span id="MJXc-Node-770" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.489em; padding-right: 0.007em;">β</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-771" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>β</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-72">\beta_t</script></li>
  <li>Let <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-73-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 113%; position: relative;"><span id="MJXc-Node-772" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-773" class="mjx-mrow"><span id="MJXc-Node-774" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-775" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.268em;">θ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-776" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span><span id="MJXc-Node-777" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.091em; padding-bottom: 0.312em;">=</span></span><span id="MJXc-Node-778" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-779" class="mjx-mo"><span class="mjx-char MJXc-TeX-size3-R" style="padding-top: 1.241em; padding-bottom: 1.241em;">(</span></span><span id="MJXc-Node-780" class="mjx-mtable" style="vertical-align: -0.96em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-781" class="mjx-mtr" style="height: 1.2em;"><span id="MJXc-Node-782" class="mjx-mtd" style="padding: 0px; width: 0.931em;"><span id="MJXc-Node-783" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-784" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-785" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">α</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-786" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-787" class="mjx-mtr" style="height: 1.219em;"><span id="MJXc-Node-788" class="mjx-mtd" style="padding: 0.2em 0px 0px;"><span id="MJXc-Node-789" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-790" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.007em;"><span id="MJXc-Node-791" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.489em; padding-right: 0.007em;">β</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-792" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-793" class="mjx-mo"><span class="mjx-char MJXc-TeX-size3-R" style="padding-top: 1.241em; padding-bottom: 1.241em;">)</span></span></span><span id="MJXc-Node-794" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.091em; padding-bottom: 0.312em;">=</span></span><span id="MJXc-Node-795" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.489em; padding-right: 0.003em;">g</span></span><span id="MJXc-Node-796" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">(</span></span><span id="MJXc-Node-797" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-798" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-799" class="mjx-texatom" style=""><span id="MJXc-Node-800" class="mjx-mrow"><span id="MJXc-Node-801" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">0</span></span><span id="MJXc-Node-802" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.135em; padding-bottom: 0.356em;">:</span></span><span id="MJXc-Node-803" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span></span></span><span id="MJXc-Node-804" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>θ</mi><mi>t</mi></msub><mo>=</mo><mrow><mo>(</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>α</mi><mi>t</mi></msub></mtd></mtr><mtr><mtd><msub><mi>β</mi><mi>t</mi></msub></mtd></mtr></mtable><mo>)</mo></mrow><mo>=</mo><mi>g</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mn>0</mn><mo>:</mo><mi>t</mi></mrow></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-73">\theta_t=\begin{pmatrix}\alpha_t\\\beta_t\end{pmatrix}=g(x_{0:t})</script> to be the output of an RNN</li>
</ul>

<p>Sequential predicting a distribution over the time to the next event can then be visualized as:
<img src="./Focus on the objective · Egils blog_files/BUIvufH.gif" alt="solution_beta_2.gif">
(So <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-74-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="font-size: 113%; position: relative;"><span id="MJXc-Node-805" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-806" class="mjx-mrow"><span id="MJXc-Node-807" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-808" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">α</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-809" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>α</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-74">\alpha_t</script> and/or <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-75-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="font-size: 113%; position: relative;"><span id="MJXc-Node-810" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-811" class="mjx-mrow"><span id="MJXc-Node-812" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.007em;"><span id="MJXc-Node-813" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.489em; padding-right: 0.007em;">β</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-814" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>β</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-75">\beta_t</script> is controlled by the feature data <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-76-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="font-size: 113%; position: relative;"><span id="MJXc-Node-815" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-816" class="mjx-mrow"><span id="MJXc-Node-817" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-818" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-819" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>x</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-76">x_t</script>)</p>

<h3 id="training-with-censored-data">Training with censored data</h3>
<p>How can we train on something that we haven’t even observed? It seems like magic but all you need is a special loss-function, some assumptions and some imagination. 
The idea comes from <a href="https://en.wikipedia.org/wiki/Survival_analysis">survival analysis</a> (you could argue that the idea <em>is</em> survival analysis). The trick is that given some assumptions regarding how the censoring happens it turns out that the <a href="https://en.wikipedia.org/wiki/Likelihood_function">likelihood</a> for the joint distribution of whether a datapoint is censored and the observed (censored) TTE can be written:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-77-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;fraktur&quot;&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x221D;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;{&lt;/mo&gt;&lt;mtable columnalign=&quot;left left&quot; rowspacing=&quot;.2em&quot; columnspacing=&quot;1em&quot; displaystyle=&quot;false&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mstyle displaystyle=&quot;false&quot; scriptlevel=&quot;0&quot;&gt;&lt;mtext&gt;if uncensored&lt;/mtext&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mstyle displaystyle=&quot;false&quot; scriptlevel=&quot;0&quot;&gt;&lt;mtext&gt;if right censored&amp;#xA0;&lt;/mtext&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo fence=&quot;true&quot; stretchy=&quot;true&quot; symmetric=&quot;true&quot;&gt;&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 113%; text-align: center; position: relative;"><span id="MJXc-Node-820" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-821" class="mjx-mrow"><span id="MJXc-Node-822" class="mjx-texatom"><span id="MJXc-Node-823" class="mjx-mrow"><span id="MJXc-Node-824" class="mjx-mi"><span class="mjx-char MJXc-TeX-frak-R" style="padding-top: 0.445em; padding-bottom: 0.312em;">L</span></span></span></span><span id="MJXc-Node-825" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">(</span></span><span id="MJXc-Node-826" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.268em;">θ</span></span><span id="MJXc-Node-827" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">)</span></span><span id="MJXc-Node-828" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.135em; padding-bottom: 0.356em;">∝</span></span><span id="MJXc-Node-829" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-830" class="mjx-mo"><span class="mjx-char MJXc-TeX-size3-R" style="padding-top: 1.241em; padding-bottom: 1.241em;">{</span></span><span id="MJXc-Node-831" class="mjx-mtable" style="vertical-align: -0.925em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-832" class="mjx-mtr" style="height: 1.175em;"><span id="MJXc-Node-833" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; text-align: left; width: 5.406em;"><span id="MJXc-Node-834" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-835" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.268em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-836" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">r</span></span><span id="MJXc-Node-837" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">(</span></span><span id="MJXc-Node-838" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.268em; padding-right: 0.182em;">Y</span></span><span id="MJXc-Node-839" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.091em; padding-bottom: 0.312em;">=</span></span><span id="MJXc-Node-840" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.489em; padding-right: 0.006em;">y</span></span><span id="MJXc-Node-841" class="mjx-texatom"><span id="MJXc-Node-842" class="mjx-mrow"><span id="MJXc-Node-843" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">|</span></span></span></span><span id="MJXc-Node-844" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.268em;">θ</span></span><span id="MJXc-Node-845" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">)</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-846" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; text-align: left; width: 7.179em;"><span id="MJXc-Node-847" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-848" class="mjx-mstyle"><span id="MJXc-Node-849" class="mjx-mrow"><span id="MJXc-Node-850" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">if uncensored</span></span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-851" class="mjx-mtr" style="height: 1.175em;"><span id="MJXc-Node-852" class="mjx-mtd" style="padding: 0.1em 0.5em 0px 0px; text-align: left;"><span id="MJXc-Node-853" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-854" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.268em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-855" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">r</span></span><span id="MJXc-Node-856" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">(</span></span><span id="MJXc-Node-857" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.268em; padding-right: 0.182em;">Y</span></span><span id="MJXc-Node-858" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.268em; padding-bottom: 0.4em;">&gt;</span></span><span id="MJXc-Node-859" class="mjx-texatom MJXc-space3"><span id="MJXc-Node-860" class="mjx-mrow"><span id="MJXc-Node-861" class="mjx-munderover"><span class="mjx-stack"><span class="mjx-over" style="height: 0.153em; padding-bottom: 0.06em; padding-left: 0.083em;"><span id="MJXc-Node-863" class="mjx-mo" style="vertical-align: top;"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.046em; padding-bottom: 0.312em;">~</span></span></span><span class="mjx-op"><span id="MJXc-Node-862" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.489em; padding-right: 0.006em;">y</span></span></span></span></span></span></span><span id="MJXc-Node-864" class="mjx-texatom"><span id="MJXc-Node-865" class="mjx-mrow"><span id="MJXc-Node-866" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">|</span></span></span></span><span id="MJXc-Node-867" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.268em;">θ</span></span><span id="MJXc-Node-868" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">)</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-869" class="mjx-mtd" style="padding: 0.1em 0px 0px 0.5em; text-align: left;"><span id="MJXc-Node-870" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-871" class="mjx-mstyle"><span id="MJXc-Node-872" class="mjx-mrow"><span id="MJXc-Node-873" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.533em;">if right censored&nbsp;</span></span></span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-874" class="mjx-mo" style="width: 0.12em;"></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="fraktur">L</mi></mrow><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>∝</mo><mrow><mo>{</mo><mtable columnalign="left left" rowspacing=".2em" columnspacing="1em" displaystyle="false"><mtr><mtd><mi>P</mi><mi>r</mi><mo stretchy="false">(</mo><mi>Y</mi><mo>=</mo><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>θ</mi><mo stretchy="false">)</mo></mtd><mtd><mstyle displaystyle="false" scriptlevel="0"><mtext>if uncensored</mtext></mstyle></mtd></mtr><mtr><mtd><mi>P</mi><mi>r</mi><mo stretchy="false">(</mo><mi>Y</mi><mo>&gt;</mo><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">~</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>θ</mi><mo stretchy="false">)</mo></mtd><mtd><mstyle displaystyle="false" scriptlevel="0"><mtext>if right censored&nbsp;</mtext></mstyle></mtd></mtr></mtable><mo fence="true" stretchy="true" symmetric="true"></mo></mrow></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-77">% <![CDATA[
\begin{equation*}
\mathfrak{L}(\theta) \propto 
	\begin{cases}
	 Pr(Y=y  |\theta) 		& \mbox{if uncensored}\\
	 Pr(Y> \tilde{y} |\theta)	& \mbox{if right censored }  \\
	\end{cases}
\end{equation*} %]]></script>

<p>There’s some mathy assumptions and proofs to justify it probabilistically (read my thesis) but the intuition why it works is pretty clear:
<img src="./Focus on the objective · Egils blog_files/2AnTHaR.png" alt="optimizing_censored.png"></p>

<p>After some manipulations we can see that the loglikelihood (<strong>objective functions</strong>) becomes (With <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-78-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="font-size: 113%; position: relative;"><span id="MJXc-Node-875" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-876" class="mjx-mrow"><span id="MJXc-Node-877" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">u</span></span><span id="MJXc-Node-878" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.091em; padding-bottom: 0.312em;">=</span></span><span id="MJXc-Node-879" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">1</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi><mo>=</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-78">u=1</script> indicating uncensored data):</p>

<table>
  <tbody>
    <tr>
      <td>continuous</td>
      <td><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-79-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 113%; position: relative;"><span id="MJXc-Node-880" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-881" class="mjx-mrow"><span id="MJXc-Node-882" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.533em;">log</span></span><span id="MJXc-Node-883" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-884" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">(</span></span><span id="MJXc-Node-885" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.489em; padding-right: 0.06em;">f</span></span><span id="MJXc-Node-886" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">(</span></span><span id="MJXc-Node-887" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.489em; padding-right: 0.006em;">y</span></span><span id="MJXc-Node-888" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-889" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">)</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-890" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">u</span></span></span></span><span id="MJXc-Node-891" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.002em; padding-bottom: 0.312em;">⋅</span></span><span id="MJXc-Node-892" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.312em; padding-right: 0.032em;">S</span></span><span id="MJXc-Node-893" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">(</span></span><span id="MJXc-Node-894" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.489em; padding-right: 0.006em;">y</span></span><span id="MJXc-Node-895" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-896" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">)</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-897" class="mjx-texatom" style=""><span id="MJXc-Node-898" class="mjx-mrow"><span id="MJXc-Node-899" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">1</span></span><span id="MJXc-Node-900" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.312em; padding-bottom: 0.445em;">−</span></span><span id="MJXc-Node-901" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">u</span></span></span></span></span></span><span id="MJXc-Node-902" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">(</mo><mi>y</mi><msup><mo stretchy="false">)</mo><mi>u</mi></msup><mo>⋅</mo><mi>S</mi><mo stretchy="false">(</mo><mi>y</mi><msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mn>1</mn><mo>−</mo><mi>u</mi></mrow></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-79">\log(f(y)^u \cdot S(y)^{1-u})</script></td>
      <td><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-80-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 113%; position: relative;"><span id="MJXc-Node-903" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-904" class="mjx-mrow"><span id="MJXc-Node-905" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.091em; padding-bottom: 0.312em;">=</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>=</mo></math></span></span><script type="math/tex" id="MathJax-Element-80">=</script></td>
      <td><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-81-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x039B;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 113%; position: relative;"><span id="MJXc-Node-906" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-907" class="mjx-mrow"><span id="MJXc-Node-908" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">u</span></span><span id="MJXc-Node-909" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.002em; padding-bottom: 0.312em;">⋅</span></span><span id="MJXc-Node-910" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.533em;">log</span></span><span id="MJXc-Node-911" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-912" class="mjx-mrow"><span id="MJXc-Node-913" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">(</span></span><span id="MJXc-Node-914" class="mjx-mrow"><span id="MJXc-Node-915" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.268em;">λ</span></span><span id="MJXc-Node-916" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">(</span></span><span id="MJXc-Node-917" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.489em; padding-right: 0.006em;">y</span></span><span id="MJXc-Node-918" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">)</span></span></span><span id="MJXc-Node-919" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">)</span></span></span><span id="MJXc-Node-920" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.312em; padding-bottom: 0.445em;">−</span></span><span id="MJXc-Node-921" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.356em;">Λ</span></span><span id="MJXc-Node-922" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">(</span></span><span id="MJXc-Node-923" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.489em; padding-right: 0.006em;">y</span></span><span id="MJXc-Node-924" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi><mo>⋅</mo><mi>log</mi><mo>⁡</mo><mrow><mo>(</mo><mrow><mi>λ</mi><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><mo>)</mo></mrow><mo>−</mo><mi mathvariant="normal">Λ</mi><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-81">u\cdot \log\left(\lambda(y)\right) - \Lambda(y)</script></td>
    </tr>
    <tr>
      <td>discrete</td>
      <td><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-82-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 113%; position: relative;"><span id="MJXc-Node-925" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-926" class="mjx-mrow"><span id="MJXc-Node-927" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.533em;">log</span></span><span id="MJXc-Node-928" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-929" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">(</span></span><span id="MJXc-Node-930" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.489em;">p</span></span><span id="MJXc-Node-931" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">(</span></span><span id="MJXc-Node-932" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.489em; padding-right: 0.006em;">y</span></span><span id="MJXc-Node-933" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-934" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">)</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-935" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">u</span></span></span></span><span id="MJXc-Node-936" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.002em; padding-bottom: 0.312em;">⋅</span></span><span id="MJXc-Node-937" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.312em; padding-right: 0.032em;">S</span></span><span id="MJXc-Node-938" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">(</span></span><span id="MJXc-Node-939" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.489em; padding-right: 0.006em;">y</span></span><span id="MJXc-Node-940" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.312em; padding-bottom: 0.445em;">+</span></span><span id="MJXc-Node-941" class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">1</span></span><span id="MJXc-Node-942" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-943" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">)</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-944" class="mjx-texatom" style=""><span id="MJXc-Node-945" class="mjx-mrow"><span id="MJXc-Node-946" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">1</span></span><span id="MJXc-Node-947" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.312em; padding-bottom: 0.445em;">−</span></span><span id="MJXc-Node-948" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">u</span></span></span></span></span></span><span id="MJXc-Node-949" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">(</mo><mi>y</mi><msup><mo stretchy="false">)</mo><mi>u</mi></msup><mo>⋅</mo><mi>S</mi><mo stretchy="false">(</mo><mi>y</mi><mo>+</mo><mn>1</mn><msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mn>1</mn><mo>−</mo><mi>u</mi></mrow></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-82">\log(p(y)^u \cdot S(y+1)^{1-u})</script></td>
      <td><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-83-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 113%; position: relative;"><span id="MJXc-Node-950" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-951" class="mjx-mrow"><span id="MJXc-Node-952" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.091em; padding-bottom: 0.312em;">=</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>=</mo></math></span></span><script type="math/tex" id="MathJax-Element-83">=</script></td>
      <td><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-84-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msup&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x039B;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x039B;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x039B;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 113%; position: relative;"><span id="MJXc-Node-953" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-954" class="mjx-mrow"><span id="MJXc-Node-955" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">u</span></span><span id="MJXc-Node-956" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.002em; padding-bottom: 0.312em;">⋅</span></span><span id="MJXc-Node-957" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.533em;">log</span></span><span id="MJXc-Node-958" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-959" class="mjx-mrow"><span id="MJXc-Node-960" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.622em; padding-bottom: 0.622em;">(</span></span><span id="MJXc-Node-961" class="mjx-mrow"><span id="MJXc-Node-962" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-963" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">e</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-964" class="mjx-texatom" style=""><span id="MJXc-Node-965" class="mjx-mrow"><span id="MJXc-Node-966" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.356em;">Λ</span></span><span id="MJXc-Node-967" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">(</span></span><span id="MJXc-Node-968" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.489em; padding-right: 0.006em;">y</span></span><span id="MJXc-Node-969" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.312em; padding-bottom: 0.445em;">+</span></span><span id="MJXc-Node-970" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">1</span></span><span id="MJXc-Node-971" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">)</span></span><span id="MJXc-Node-972" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.312em; padding-bottom: 0.445em;">−</span></span><span id="MJXc-Node-973" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.356em;">Λ</span></span><span id="MJXc-Node-974" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">(</span></span><span id="MJXc-Node-975" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span><span id="MJXc-Node-976" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">)</span></span></span></span></span></span><span id="MJXc-Node-977" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.312em; padding-bottom: 0.445em;">−</span></span><span id="MJXc-Node-978" class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">1</span></span></span><span id="MJXc-Node-979" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.622em; padding-bottom: 0.622em;">)</span></span></span><span id="MJXc-Node-980" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.312em; padding-bottom: 0.445em;">−</span></span><span id="MJXc-Node-981" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.356em;">Λ</span></span><span id="MJXc-Node-982" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">(</span></span><span id="MJXc-Node-983" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.489em; padding-right: 0.006em;">y</span></span><span id="MJXc-Node-984" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.312em; padding-bottom: 0.445em;">+</span></span><span id="MJXc-Node-985" class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">1</span></span><span id="MJXc-Node-986" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi><mo>⋅</mo><mi>log</mi><mo>⁡</mo><mrow><mo>(</mo><mrow><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">Λ</mi><mo stretchy="false">(</mo><mi>y</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo>−</mo><mi mathvariant="normal">Λ</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></msup><mo>−</mo><mn>1</mn></mrow><mo>)</mo></mrow><mo>−</mo><mi mathvariant="normal">Λ</mi><mo stretchy="false">(</mo><mi>y</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-84">u\cdot \log\left(e^{\Lambda(y+1)-\Lambda(t)}-1\right) - \Lambda(y+1)</script></td>
    </tr>
  </tbody>
</table>

<p>To satisfy the assumptions to warrant its use we need <em>uninformative censoring</em>. With <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-85-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 113%; position: relative;"><span id="MJXc-Node-987" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-988" class="mjx-mrow"><span id="MJXc-Node-989" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.312em; padding-right: 0.045em;">C</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi></math></span></span><script type="math/tex" id="MathJax-Element-85">C</script> the censoring time, or the <strong>censoring variable</strong> then we need:</p>

<p>1) <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-86-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mo&gt;&amp;#x22A5;&lt;/mo&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 113%; position: relative;"><span id="MJXc-Node-990" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-991" class="mjx-mrow"><span id="MJXc-Node-992" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.268em; padding-right: 0.182em;">Y</span></span><span id="MJXc-Node-993" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">⊥</span></span><span id="MJXc-Node-994" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.312em; padding-right: 0.045em;">C</span></span><span id="MJXc-Node-995" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">∥</span></span><span id="MJXc-Node-996" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.268em;">θ</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Y</mi><mo>⊥</mo><mi>C</mi><mo fence="false" stretchy="false">‖</mo><mi>θ</mi></math></span></span><script type="math/tex" id="MathJax-Element-86">Y \perp C \| \theta</script></p>

<p>2) <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-87-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo&gt;&amp;#x22A5;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 113%; position: relative;"><span id="MJXc-Node-997" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-998" class="mjx-mrow"><span id="MJXc-Node-999" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.312em; padding-right: 0.045em;">C</span></span><span id="MJXc-Node-1000" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">⊥</span></span><span id="MJXc-Node-1001" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.268em;">θ</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi><mo>⊥</mo><mi>θ</mi></math></span></span><script type="math/tex" id="MathJax-Element-87">C \perp \theta</script></p>

<p>I.e you get no information about the parameter or the distribution of the TTE by knowing the censoring time.</p>

<p>A weaker assumption exists but its kind of complicated. A good indicator of whether your assumptions are met from the original problems point of view is to see if you can predict the time to the censoring point using your feature data. If you can, the algo will learn this artifact so try to mask your features so that they don’t contain too much of this information.</p>

<p>Be cautious but don’t worry too much. If the entry time of your customers is somewhat random you can see the observation window over your timelines as a kind of slot machine making the censoring point random.</p>

<p>So to train with censored data we need to assume that the distribution has some basic shape governed by a few parameters. You can choose any distribution but I think there’s one obvious choice:</p>

<h3 id="embrace-the-weibull-euphoria">Embrace the Weibull Euphoria</h3>
<p>In the 60’s and 70s the Weibull-distribution was trending. It was said to be a universal PDF for scientists and engineers. This even went so far that it warranted the famous call to <a href="https://www.researchgate.net/publication/224582459_Beware_of_the_Weibull_Euphoria">beware of the Weibull euphoria</a>. There’s many reasons not to.</p>

<p>The Weibull distribution has a</p>

<ul>
  <li>Continuous and discrete variant</li>
  <li>Expressive. Can take many shapes by adjusting its two parameters.</li>
  <li>Closed form PDF, CDF, PMF, expected value, Median, Mode, Quantile function (inverse CDF)</li>
  <li>Used everywhere for predicting things that will brake since it magically appears in nature just like the normal distribution</li>
  <li>Weakest link property : If a system breaks with the failure of any of its independent identical components then the time to failure is approximately Weibull distributed.</li>
  <li>Built in regularization mechanisms. By controlling the size of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-88-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 113%; position: relative;"><span id="MJXc-Node-1002" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1003" class="mjx-mrow"><span id="MJXc-Node-1004" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.489em; padding-right: 0.007em;">β</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>β</mi></math></span></span><script type="math/tex" id="MathJax-Element-88">\beta</script> we control the peakedness hence the confidence of predicted location.</li>
</ul>

<p>The continuous <a href="https://en.wikipedia.org/wiki/Weibull_distribution">Weibull distribution</a> and its <a href="https://en.wikipedia.org/wiki/Discrete_Weibull_distribution">discretized variant</a> has</p>

<table>
  <tbody>
    <tr>
      <td>CHF</td>
      <td><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-89-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x039B;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msubsup&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/msubsup&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 113%; position: relative;"><span id="MJXc-Node-1005" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1006" class="mjx-mrow"><span id="MJXc-Node-1007" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.356em;">Λ</span></span><span id="MJXc-Node-1008" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">(</span></span><span id="MJXc-Node-1009" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">w</span></span><span id="MJXc-Node-1010" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">)</span></span><span id="MJXc-Node-1011" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.091em; padding-bottom: 0.312em;">=</span></span><span id="MJXc-Node-1012" class="mjx-msubsup MJXc-space3"><span class="mjx-base" style="margin-right: -0.138em;"><span id="MJXc-Node-1013" class="mjx-mo" style="padding-right: 0.138em;"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.577em; padding-bottom: 0.577em;">∫</span></span></span><span class="mjx-stack" style="vertical-align: -0.366em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.579em; padding-left: 0.324em; padding-right: 0.071em;"><span id="MJXc-Node-1015" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">w</span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-1014" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">0</span></span></span></span></span><span id="MJXc-Node-1016" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.268em;">λ</span></span><span id="MJXc-Node-1017" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">(</span></span><span id="MJXc-Node-1018" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span><span id="MJXc-Node-1019" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">)</span></span><span id="MJXc-Node-1020" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.268em; padding-right: 0.003em;">d</span></span><span id="MJXc-Node-1021" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Λ</mi><mo stretchy="false">(</mo><mi>w</mi><mo stretchy="false">)</mo><mo>=</mo><msubsup><mo>∫</mo><mn>0</mn><mi>w</mi></msubsup><mi>λ</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mi>d</mi><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-89">\Lambda(w) = \int_0^w \lambda(t)dt</script></td>
      <td><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-90-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mfrac&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;/mfrac&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="font-size: 113%; position: relative;"><span id="MJXc-Node-1022" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1023" class="mjx-mrow"><span id="MJXc-Node-1024" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.091em; padding-bottom: 0.312em;">=</span></span><span id="MJXc-Node-1025" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-1026" class="mjx-mrow"><span id="MJXc-Node-1027" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.622em; padding-bottom: 0.622em;">(</span></span><span id="MJXc-Node-1028" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 0.648em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 0.916em; top: -1.06em;"><span id="MJXc-Node-1029" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">w</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 0.916em; bottom: -0.524em;"><span id="MJXc-Node-1030" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">α</span></span></span><span class="mjx-line" style="border-bottom: 1.4px solid; top: -0.28em; width: 0.648em;"></span></span><span class="mjx-vsize" style="height: 1.12em; vertical-align: -0.37em;"></span></span><span id="MJXc-Node-1031" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.622em; padding-bottom: 0.622em;">)</span></span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.851em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1032" class="mjx-texatom" style=""><span id="MJXc-Node-1033" class="mjx-mrow"><span id="MJXc-Node-1034" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.489em; padding-right: 0.007em;">β</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>=</mo><msup><mrow><mo>(</mo><mfrac><mi>w</mi><mi>α</mi></mfrac><mo>)</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi>β</mi></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-90">= \left(\frac{w}{\alpha}\right)^{\beta}</script></td>
    </tr>
    <tr>
      <td>HF</td>
      <td><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-91-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x039B;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 113%; position: relative;"><span id="MJXc-Node-1035" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1036" class="mjx-mrow"><span id="MJXc-Node-1037" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.268em;">λ</span></span><span id="MJXc-Node-1038" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">(</span></span><span id="MJXc-Node-1039" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">w</span></span><span id="MJXc-Node-1040" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">)</span></span><span id="MJXc-Node-1041" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.091em; padding-bottom: 0.312em;">=</span></span><span id="MJXc-Node-1042" class="mjx-msup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-1043" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.356em;">Λ</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1044" class="mjx-mo" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.268em; padding-bottom: 0.312em;">′</span></span></span></span><span id="MJXc-Node-1045" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">(</span></span><span id="MJXc-Node-1046" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">w</span></span><span id="MJXc-Node-1047" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>λ</mi><mo stretchy="false">(</mo><mi>w</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mi mathvariant="normal">Λ</mi><mo>′</mo></msup><mo stretchy="false">(</mo><mi>w</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-91">\lambda(w) = \Lambda'(w)</script></td>
      <td><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-92-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mfrac&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;/mfrac&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mfrac&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;/mfrac&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="font-size: 113%; position: relative;"><span id="MJXc-Node-1048" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1049" class="mjx-mrow"><span id="MJXc-Node-1050" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.091em; padding-bottom: 0.312em;">=</span></span><span id="MJXc-Node-1051" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-1052" class="mjx-mo"><span class="mjx-char MJXc-TeX-size2-R" style="padding-top: 0.931em; padding-bottom: 0.931em;">(</span></span><span id="MJXc-Node-1053" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 0.594em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 0.84em; top: -1.505em;"><span id="MJXc-Node-1054" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.489em; padding-right: 0.007em;">β</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 0.84em; bottom: -0.524em;"><span id="MJXc-Node-1055" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">α</span></span></span><span class="mjx-line" style="border-bottom: 1.4px solid; top: -0.28em; width: 0.594em;"></span></span><span class="mjx-vsize" style="height: 1.434em; vertical-align: -0.37em;"></span></span><span id="MJXc-Node-1056" class="mjx-mo"><span class="mjx-char MJXc-TeX-size2-R" style="padding-top: 0.931em; padding-bottom: 0.931em;">)</span></span></span><span id="MJXc-Node-1057" class="mjx-msubsup MJXc-space1"><span class="mjx-base"><span id="MJXc-Node-1058" class="mjx-mrow"><span id="MJXc-Node-1059" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.622em; padding-bottom: 0.622em;">(</span></span><span id="MJXc-Node-1060" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 0.648em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 0.916em; top: -1.06em;"><span id="MJXc-Node-1061" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">w</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 0.916em; bottom: -0.524em;"><span id="MJXc-Node-1062" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">α</span></span></span><span class="mjx-line" style="border-bottom: 1.4px solid; top: -0.28em; width: 0.648em;"></span></span><span class="mjx-vsize" style="height: 1.12em; vertical-align: -0.37em;"></span></span><span id="MJXc-Node-1063" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.622em; padding-bottom: 0.622em;">)</span></span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.851em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1064" class="mjx-texatom" style=""><span id="MJXc-Node-1065" class="mjx-mrow"><span id="MJXc-Node-1066" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.489em; padding-right: 0.007em;">β</span></span><span id="MJXc-Node-1067" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.312em; padding-bottom: 0.445em;">−</span></span><span id="MJXc-Node-1068" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">1</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>=</mo><mrow><mo>(</mo><mfrac><mi>β</mi><mi>α</mi></mfrac><mo>)</mo></mrow><msup><mrow><mo>(</mo><mfrac><mi>w</mi><mi>α</mi></mfrac><mo>)</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi>β</mi><mo>−</mo><mn>1</mn></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-92">= \left(\frac{\beta}{\alpha}\right)\left(\frac{w}{\alpha}\right)^{\beta-1}</script></td>
    </tr>
    <tr>
      <td>CDF</td>
      <td><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-93-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x039B;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="font-size: 113%; position: relative;"><span id="MJXc-Node-1069" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1070" class="mjx-mrow"><span id="MJXc-Node-1071" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.268em; padding-right: 0.106em;">F</span></span><span id="MJXc-Node-1072" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">(</span></span><span id="MJXc-Node-1073" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">w</span></span><span id="MJXc-Node-1074" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">)</span></span><span id="MJXc-Node-1075" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.091em; padding-bottom: 0.312em;">=</span></span><span id="MJXc-Node-1076" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">1</span></span><span id="MJXc-Node-1077" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.312em; padding-bottom: 0.445em;">−</span></span><span id="MJXc-Node-1078" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-1079" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">e</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1080" class="mjx-texatom" style=""><span id="MJXc-Node-1081" class="mjx-mrow"><span id="MJXc-Node-1082" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.312em; padding-bottom: 0.445em;">−</span></span><span id="MJXc-Node-1083" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.356em;">Λ</span></span><span id="MJXc-Node-1084" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">(</span></span><span id="MJXc-Node-1085" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">w</span></span><span id="MJXc-Node-1086" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">)</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>F</mi><mo stretchy="false">(</mo><mi>w</mi><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn><mo>−</mo><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mi mathvariant="normal">Λ</mi><mo stretchy="false">(</mo><mi>w</mi><mo stretchy="false">)</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-93">F(w) = 1-e^{-\Lambda(w)}</script></td>
      <td><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-94-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mfrac&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;/mfrac&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="font-size: 113%; position: relative;"><span id="MJXc-Node-1087" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1088" class="mjx-mrow"><span id="MJXc-Node-1089" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.091em; padding-bottom: 0.312em;">=</span></span><span id="MJXc-Node-1090" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">1</span></span><span id="MJXc-Node-1091" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.312em; padding-bottom: 0.445em;">−</span></span><span id="MJXc-Node-1092" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-1093" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">e</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.53em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1094" class="mjx-texatom" style=""><span id="MJXc-Node-1095" class="mjx-mrow"><span id="MJXc-Node-1096" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.312em; padding-bottom: 0.445em;">−</span></span><span id="MJXc-Node-1097" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1098" class="mjx-mrow"><span id="MJXc-Node-1099" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.622em; padding-bottom: 0.622em;">(</span></span><span id="MJXc-Node-1100" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 0.648em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 0.916em; top: -1.095em;"><span id="MJXc-Node-1101" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">w</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 0.916em; bottom: -0.524em;"><span id="MJXc-Node-1102" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">α</span></span></span><span class="mjx-line" style="border-bottom: 1.4px solid; top: -0.292em; width: 0.648em;"></span></span><span class="mjx-vsize" style="height: 1.144em; vertical-align: -0.37em;"></span></span><span id="MJXc-Node-1103" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.622em; padding-bottom: 0.622em;">)</span></span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.851em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1104" class="mjx-texatom" style=""><span id="MJXc-Node-1105" class="mjx-mrow"><span id="MJXc-Node-1106" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.489em; padding-right: 0.007em;">β</span></span></span></span></span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>=</mo><mn>1</mn><mo>−</mo><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><msup><mrow><mo>(</mo><mfrac><mi>w</mi><mi>α</mi></mfrac><mo>)</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi>β</mi></mrow></msup></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-94">= 1-e^{-\left(\frac{w}{\alpha}\right)^{\beta}}</script></td>
    </tr>
    <tr>
      <td>SF</td>
      <td><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-95-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x039B;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="font-size: 113%; position: relative;"><span id="MJXc-Node-1107" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1108" class="mjx-mrow"><span id="MJXc-Node-1109" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.312em; padding-right: 0.032em;">S</span></span><span id="MJXc-Node-1110" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">(</span></span><span id="MJXc-Node-1111" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">w</span></span><span id="MJXc-Node-1112" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">)</span></span><span id="MJXc-Node-1113" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.091em; padding-bottom: 0.312em;">=</span></span><span id="MJXc-Node-1114" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-1115" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">e</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1116" class="mjx-texatom" style=""><span id="MJXc-Node-1117" class="mjx-mrow"><span id="MJXc-Node-1118" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.312em; padding-bottom: 0.445em;">−</span></span><span id="MJXc-Node-1119" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.356em;">Λ</span></span><span id="MJXc-Node-1120" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">(</span></span><span id="MJXc-Node-1121" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">w</span></span><span id="MJXc-Node-1122" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">)</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>S</mi><mo stretchy="false">(</mo><mi>w</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mi mathvariant="normal">Λ</mi><mo stretchy="false">(</mo><mi>w</mi><mo stretchy="false">)</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-95">S(w) = e^{-\Lambda(w)}</script></td>
      <td><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-96-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mfrac&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;/mfrac&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="font-size: 113%; position: relative;"><span id="MJXc-Node-1123" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1124" class="mjx-mrow"><span id="MJXc-Node-1125" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.091em; padding-bottom: 0.312em;">=</span></span><span id="MJXc-Node-1126" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-1127" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">e</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.53em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1128" class="mjx-texatom" style=""><span id="MJXc-Node-1129" class="mjx-mrow"><span id="MJXc-Node-1130" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.312em; padding-bottom: 0.445em;">−</span></span><span id="MJXc-Node-1131" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1132" class="mjx-mrow"><span id="MJXc-Node-1133" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.622em; padding-bottom: 0.622em;">(</span></span><span id="MJXc-Node-1134" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 0.648em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 0.916em; top: -1.095em;"><span id="MJXc-Node-1135" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">w</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 0.916em; bottom: -0.524em;"><span id="MJXc-Node-1136" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">α</span></span></span><span class="mjx-line" style="border-bottom: 1.4px solid; top: -0.292em; width: 0.648em;"></span></span><span class="mjx-vsize" style="height: 1.144em; vertical-align: -0.37em;"></span></span><span id="MJXc-Node-1137" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.622em; padding-bottom: 0.622em;">)</span></span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.851em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1138" class="mjx-texatom" style=""><span id="MJXc-Node-1139" class="mjx-mrow"><span id="MJXc-Node-1140" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.489em; padding-right: 0.007em;">β</span></span></span></span></span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>=</mo><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><msup><mrow><mo>(</mo><mfrac><mi>w</mi><mi>α</mi></mfrac><mo>)</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi>β</mi></mrow></msup></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-96">= e^{-\left(\frac{w}{\alpha}\right)^{\beta}}</script></td>
    </tr>
    <tr>
      <td>PDF</td>
      <td><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-97-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x039B;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x039B;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="font-size: 113%; position: relative;"><span id="MJXc-Node-1141" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1142" class="mjx-mrow"><span id="MJXc-Node-1143" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.489em; padding-right: 0.06em;">f</span></span><span id="MJXc-Node-1144" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">(</span></span><span id="MJXc-Node-1145" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">w</span></span><span id="MJXc-Node-1146" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">)</span></span><span id="MJXc-Node-1147" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.091em; padding-bottom: 0.312em;">=</span></span><span id="MJXc-Node-1148" class="mjx-msup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-1149" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.356em;">Λ</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1150" class="mjx-mo" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.268em; padding-bottom: 0.312em;">′</span></span></span></span><span id="MJXc-Node-1151" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">(</span></span><span id="MJXc-Node-1152" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">w</span></span><span id="MJXc-Node-1153" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">)</span></span><span id="MJXc-Node-1154" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1155" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">e</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1156" class="mjx-texatom" style=""><span id="MJXc-Node-1157" class="mjx-mrow"><span id="MJXc-Node-1158" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.312em; padding-bottom: 0.445em;">−</span></span><span id="MJXc-Node-1159" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.356em;">Λ</span></span><span id="MJXc-Node-1160" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">(</span></span><span id="MJXc-Node-1161" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">w</span></span><span id="MJXc-Node-1162" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">)</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi>w</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mi mathvariant="normal">Λ</mi><mo>′</mo></msup><mo stretchy="false">(</mo><mi>w</mi><mo stretchy="false">)</mo><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mi mathvariant="normal">Λ</mi><mo stretchy="false">(</mo><mi>w</mi><mo stretchy="false">)</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-97">f(w) = \Lambda'(w)e^{-\Lambda(w)}</script></td>
      <td><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-98-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mfrac&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;/mfrac&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mfrac&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;/mfrac&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;msup&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mfrac&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;/mfrac&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="font-size: 113%; position: relative;"><span id="MJXc-Node-1163" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1164" class="mjx-mrow"><span id="MJXc-Node-1165" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.091em; padding-bottom: 0.312em;">=</span></span><span id="MJXc-Node-1166" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-1167" class="mjx-mo"><span class="mjx-char MJXc-TeX-size2-R" style="padding-top: 0.931em; padding-bottom: 0.931em;">(</span></span><span id="MJXc-Node-1168" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 0.594em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 0.84em; top: -1.505em;"><span id="MJXc-Node-1169" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.489em; padding-right: 0.007em;">β</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 0.84em; bottom: -0.524em;"><span id="MJXc-Node-1170" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">α</span></span></span><span class="mjx-line" style="border-bottom: 1.4px solid; top: -0.28em; width: 0.594em;"></span></span><span class="mjx-vsize" style="height: 1.434em; vertical-align: -0.37em;"></span></span><span id="MJXc-Node-1171" class="mjx-mo"><span class="mjx-char MJXc-TeX-size2-R" style="padding-top: 0.931em; padding-bottom: 0.931em;">)</span></span></span><span id="MJXc-Node-1172" class="mjx-msubsup MJXc-space1"><span class="mjx-base"><span id="MJXc-Node-1173" class="mjx-mrow"><span id="MJXc-Node-1174" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.622em; padding-bottom: 0.622em;">(</span></span><span id="MJXc-Node-1175" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 0.648em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 0.916em; top: -1.06em;"><span id="MJXc-Node-1176" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">w</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 0.916em; bottom: -0.524em;"><span id="MJXc-Node-1177" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">α</span></span></span><span class="mjx-line" style="border-bottom: 1.4px solid; top: -0.28em; width: 0.648em;"></span></span><span class="mjx-vsize" style="height: 1.12em; vertical-align: -0.37em;"></span></span><span id="MJXc-Node-1178" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.622em; padding-bottom: 0.622em;">)</span></span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.851em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1179" class="mjx-texatom" style=""><span id="MJXc-Node-1180" class="mjx-mrow"><span id="MJXc-Node-1181" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.489em; padding-right: 0.007em;">β</span></span><span id="MJXc-Node-1182" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.312em; padding-bottom: 0.445em;">−</span></span><span id="MJXc-Node-1183" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">1</span></span></span></span></span></span><span id="MJXc-Node-1184" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1185" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">e</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.53em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1186" class="mjx-texatom" style=""><span id="MJXc-Node-1187" class="mjx-mrow"><span id="MJXc-Node-1188" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.312em; padding-bottom: 0.445em;">−</span></span><span id="MJXc-Node-1189" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1190" class="mjx-mrow"><span id="MJXc-Node-1191" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.622em; padding-bottom: 0.622em;">(</span></span><span id="MJXc-Node-1192" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 0.648em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 0.916em; top: -1.095em;"><span id="MJXc-Node-1193" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">w</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 0.916em; bottom: -0.524em;"><span id="MJXc-Node-1194" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">α</span></span></span><span class="mjx-line" style="border-bottom: 1.4px solid; top: -0.292em; width: 0.648em;"></span></span><span class="mjx-vsize" style="height: 1.144em; vertical-align: -0.37em;"></span></span><span id="MJXc-Node-1195" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.622em; padding-bottom: 0.622em;">)</span></span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.851em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1196" class="mjx-texatom" style=""><span id="MJXc-Node-1197" class="mjx-mrow"><span id="MJXc-Node-1198" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.489em; padding-right: 0.007em;">β</span></span></span></span></span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>=</mo><mrow><mo>(</mo><mfrac><mi>β</mi><mi>α</mi></mfrac><mo>)</mo></mrow><msup><mrow><mo>(</mo><mfrac><mi>w</mi><mi>α</mi></mfrac><mo>)</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi>β</mi><mo>−</mo><mn>1</mn></mrow></msup><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><msup><mrow><mo>(</mo><mfrac><mi>w</mi><mi>α</mi></mfrac><mo>)</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi>β</mi></mrow></msup></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-98">=\left(\frac{\beta}{\alpha}\right)\left(\frac{w}{\alpha}\right)^{\beta-1}e^{-\left(\frac{w}{\alpha}\right)^{\beta}}</script></td>
    </tr>
    <tr>
      <td>CDF</td>
      <td><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-99-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;/mfrac&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="font-size: 113%; position: relative;"><span id="MJXc-Node-1199" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1200" class="mjx-mrow"><span id="MJXc-Node-1201" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.268em; padding-right: 0.106em;">F</span></span><span id="MJXc-Node-1202" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">(</span></span><span id="MJXc-Node-1203" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">w</span></span><span id="MJXc-Node-1204" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">)</span></span><span id="MJXc-Node-1205" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.091em; padding-bottom: 0.312em;">=</span></span><span id="MJXc-Node-1206" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">1</span></span><span id="MJXc-Node-1207" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.312em; padding-bottom: 0.445em;">−</span></span><span id="MJXc-Node-1208" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-1209" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">e</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.83em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1210" class="mjx-texatom" style=""><span id="MJXc-Node-1211" class="mjx-mrow"><span id="MJXc-Node-1212" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.312em; padding-bottom: 0.445em;">−</span></span><span id="MJXc-Node-1213" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1214" class="mjx-mrow"><span id="MJXc-Node-1215" class="mjx-mo"><span class="mjx-char MJXc-TeX-size2-R" style="padding-top: 0.931em; padding-bottom: 0.931em;">(</span></span><span id="MJXc-Node-1216" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 1.551em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 2.194em; top: -1.389em;"><span id="MJXc-Node-1217" class="mjx-mrow" style=""><span id="MJXc-Node-1218" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">w</span></span><span id="MJXc-Node-1219" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.312em; padding-bottom: 0.445em;">+</span></span><span id="MJXc-Node-1220" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">1</span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 2.194em; bottom: -0.524em;"><span id="MJXc-Node-1221" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">α</span></span></span><span class="mjx-line" style="border-bottom: 1.4px solid; top: -0.292em; width: 1.551em;"></span></span><span class="mjx-vsize" style="height: 1.352em; vertical-align: -0.37em;"></span></span><span id="MJXc-Node-1222" class="mjx-mo"><span class="mjx-char MJXc-TeX-size2-R" style="padding-top: 0.931em; padding-bottom: 0.931em;">)</span></span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 1.276em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1223" class="mjx-texatom" style=""><span id="MJXc-Node-1224" class="mjx-mrow"><span id="MJXc-Node-1225" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.489em; padding-right: 0.007em;">β</span></span></span></span></span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>F</mi><mo stretchy="false">(</mo><mi>w</mi><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn><mo>−</mo><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><msup><mrow><mo>(</mo><mfrac><mrow><mi>w</mi><mo>+</mo><mn>1</mn></mrow><mi>α</mi></mfrac><mo>)</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi>β</mi></mrow></msup></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-99">F(w) = 1-e^{-\left(\frac{w+1}{\alpha}\right)^{\beta}}</script></td>
      <td><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-100-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x039B;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="font-size: 113%; position: relative;"><span id="MJXc-Node-1226" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1227" class="mjx-mrow"><span id="MJXc-Node-1228" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.091em; padding-bottom: 0.312em;">=</span></span><span id="MJXc-Node-1229" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">1</span></span><span id="MJXc-Node-1230" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.312em; padding-bottom: 0.445em;">−</span></span><span id="MJXc-Node-1231" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-1232" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">e</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1233" class="mjx-texatom" style=""><span id="MJXc-Node-1234" class="mjx-mrow"><span id="MJXc-Node-1235" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.312em; padding-bottom: 0.445em;">−</span></span><span id="MJXc-Node-1236" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.356em;">Λ</span></span><span id="MJXc-Node-1237" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">(</span></span><span id="MJXc-Node-1238" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">w</span></span><span id="MJXc-Node-1239" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">)</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>=</mo><mn>1</mn><mo>−</mo><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mi mathvariant="normal">Λ</mi><mo stretchy="false">(</mo><mi>w</mi><mo stretchy="false">)</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-100">= 1-e^{-\Lambda(w)}</script></td>
    </tr>
    <tr>
      <td>PMF</td>
      <td><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-101-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x039B;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x039B;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="font-size: 113%; position: relative;"><span id="MJXc-Node-1240" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1241" class="mjx-mrow"><span id="MJXc-Node-1242" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.489em;">p</span></span><span id="MJXc-Node-1243" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">(</span></span><span id="MJXc-Node-1244" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">w</span></span><span id="MJXc-Node-1245" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">)</span></span><span id="MJXc-Node-1246" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.091em; padding-bottom: 0.312em;">=</span></span><span id="MJXc-Node-1247" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-1248" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">e</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1249" class="mjx-texatom" style=""><span id="MJXc-Node-1250" class="mjx-mrow"><span id="MJXc-Node-1251" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.312em; padding-bottom: 0.445em;">−</span></span><span id="MJXc-Node-1252" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.356em;">Λ</span></span><span id="MJXc-Node-1253" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">(</span></span><span id="MJXc-Node-1254" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">w</span></span><span id="MJXc-Node-1255" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">)</span></span></span></span></span></span><span id="MJXc-Node-1256" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.312em; padding-bottom: 0.445em;">−</span></span><span id="MJXc-Node-1257" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-1258" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">e</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1259" class="mjx-texatom" style=""><span id="MJXc-Node-1260" class="mjx-mrow"><span id="MJXc-Node-1261" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.312em; padding-bottom: 0.445em;">−</span></span><span id="MJXc-Node-1262" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.356em;">Λ</span></span><span id="MJXc-Node-1263" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">(</span></span><span id="MJXc-Node-1264" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">w</span></span><span id="MJXc-Node-1265" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.312em; padding-bottom: 0.445em;">+</span></span><span id="MJXc-Node-1266" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">1</span></span><span id="MJXc-Node-1267" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">)</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo stretchy="false">(</mo><mi>w</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mi mathvariant="normal">Λ</mi><mo stretchy="false">(</mo><mi>w</mi><mo stretchy="false">)</mo></mrow></msup><mo>−</mo><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mi mathvariant="normal">Λ</mi><mo stretchy="false">(</mo><mi>w</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-101">p(w) =e^{-\Lambda(w)}-e^{-\Lambda(w+1)}</script></td>
      <td><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-102-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mfrac&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;/mfrac&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;/mfrac&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="font-size: 113%; position: relative;"><span id="MJXc-Node-1268" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1269" class="mjx-mrow"><span id="MJXc-Node-1270" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.091em; padding-bottom: 0.312em;">=</span></span><span id="MJXc-Node-1271" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-1272" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">e</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.53em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1273" class="mjx-texatom" style=""><span id="MJXc-Node-1274" class="mjx-mrow"><span id="MJXc-Node-1275" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.312em; padding-bottom: 0.445em;">−</span></span><span id="MJXc-Node-1276" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1277" class="mjx-mrow"><span id="MJXc-Node-1278" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.622em; padding-bottom: 0.622em;">(</span></span><span id="MJXc-Node-1279" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 0.648em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 0.916em; top: -1.095em;"><span id="MJXc-Node-1280" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">w</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 0.916em; bottom: -0.524em;"><span id="MJXc-Node-1281" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">α</span></span></span><span class="mjx-line" style="border-bottom: 1.4px solid; top: -0.292em; width: 0.648em;"></span></span><span class="mjx-vsize" style="height: 1.144em; vertical-align: -0.37em;"></span></span><span id="MJXc-Node-1282" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.622em; padding-bottom: 0.622em;">)</span></span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.851em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1283" class="mjx-texatom" style=""><span id="MJXc-Node-1284" class="mjx-mrow"><span id="MJXc-Node-1285" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.489em; padding-right: 0.007em;">β</span></span></span></span></span></span></span></span></span></span><span id="MJXc-Node-1286" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.312em; padding-bottom: 0.445em;">−</span></span><span id="MJXc-Node-1287" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-1288" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">e</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.83em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1289" class="mjx-texatom" style=""><span id="MJXc-Node-1290" class="mjx-mrow"><span id="MJXc-Node-1291" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.312em; padding-bottom: 0.445em;">−</span></span><span id="MJXc-Node-1292" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1293" class="mjx-mrow"><span id="MJXc-Node-1294" class="mjx-mo"><span class="mjx-char MJXc-TeX-size2-R" style="padding-top: 0.931em; padding-bottom: 0.931em;">(</span></span><span id="MJXc-Node-1295" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 1.551em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 2.194em; top: -1.389em;"><span id="MJXc-Node-1296" class="mjx-mrow" style=""><span id="MJXc-Node-1297" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">w</span></span><span id="MJXc-Node-1298" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.312em; padding-bottom: 0.445em;">+</span></span><span id="MJXc-Node-1299" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">1</span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 2.194em; bottom: -0.524em;"><span id="MJXc-Node-1300" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">α</span></span></span><span class="mjx-line" style="border-bottom: 1.4px solid; top: -0.292em; width: 1.551em;"></span></span><span class="mjx-vsize" style="height: 1.352em; vertical-align: -0.37em;"></span></span><span id="MJXc-Node-1301" class="mjx-mo"><span class="mjx-char MJXc-TeX-size2-R" style="padding-top: 0.931em; padding-bottom: 0.931em;">)</span></span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 1.276em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1302" class="mjx-texatom" style=""><span id="MJXc-Node-1303" class="mjx-mrow"><span id="MJXc-Node-1304" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.489em; padding-right: 0.007em;">β</span></span></span></span></span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>=</mo><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><msup><mrow><mo>(</mo><mfrac><mi>w</mi><mi>α</mi></mfrac><mo>)</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi>β</mi></mrow></msup></mrow></msup><mo>−</mo><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><msup><mrow><mo>(</mo><mfrac><mrow><mi>w</mi><mo>+</mo><mn>1</mn></mrow><mi>α</mi></mfrac><mo>)</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi>β</mi></mrow></msup></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-102">= e^{-\left(\frac{w}{\alpha}\right)^{\beta}}-e^{-\left(\frac{w+1}{\alpha}\right)^{\beta}}</script></td>
    </tr>
  </tbody>
</table>

<p>We can use it to approximate alot of shapes of distributions. We can let it become infinitely flat or infinetely spiky and it can model hazard rates (also called <a href="https://en.wikipedia.org/wiki/Failure_rate">failure rate</a>) that are decreasing (<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-103-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="font-size: 113%; position: relative;"><span id="MJXc-Node-1305" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1306" class="mjx-mrow"><span id="MJXc-Node-1307" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.489em; padding-right: 0.007em;">β</span></span><span id="MJXc-Node-1308" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.268em; padding-bottom: 0.4em;">&lt;</span></span><span id="MJXc-Node-1309" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">1</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>β</mi><mo>&lt;</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-103">% <![CDATA[
\beta<1 %]]></script>), constant (<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-104-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="font-size: 113%; position: relative;"><span id="MJXc-Node-1310" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1311" class="mjx-mrow"><span id="MJXc-Node-1312" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.489em; padding-right: 0.007em;">β</span></span><span id="MJXc-Node-1313" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.091em; padding-bottom: 0.312em;">=</span></span><span id="MJXc-Node-1314" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">1</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>β</mi><mo>=</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-104">\beta=1</script>), or increasing (<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-105-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="font-size: 113%; position: relative;"><span id="MJXc-Node-1315" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1316" class="mjx-mrow"><span id="MJXc-Node-1317" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.489em; padding-right: 0.007em;">β</span></span><span id="MJXc-Node-1318" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.268em; padding-bottom: 0.4em;">&gt;</span></span><span id="MJXc-Node-1319" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">1</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>β</mi><mo>&gt;</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-105">\beta>1</script>).</p>

<iframe allowfullscreen="true" mozallowfullscreen="true" webkitallowfullscreen="true" class="imgur-embed-iframe-pub imgur-embed-iframe-pub-maUHyto-true-540" scrolling="no" src="./Focus on the objective · Egils blog_files/embed.html" id="imgur-embed-iframe-pub-maUHyto" style="height: 500px; width: 540px; margin: 10px 0px; padding: 0px;"></iframe>
<script async="" src="./Focus on the objective · Egils blog_files/embed.js" charset="utf-8"></script>

<p>The <a href="https://en.wikipedia.org/wiki/Exponential_distribution">exponential</a> and the discrete <a href="https://en.wikipedia.org/wiki/Geometric_distribution">geometric</a> distribution is the special case when <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-106-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="font-size: 113%; position: relative;"><span id="MJXc-Node-1320" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1321" class="mjx-mrow"><span id="MJXc-Node-1322" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.489em; padding-right: 0.007em;">β</span></span><span id="MJXc-Node-1323" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.091em; padding-bottom: 0.312em;">=</span></span><span id="MJXc-Node-1324" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">1</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>β</mi><mo>=</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-106">\beta=1</script>. This means that the exponential- and Weibull <a href="https://en.wikipedia.org/wiki/Accelerated_failure_time_model">Accelerated Failure Time model</a> and the <a href="https://en.wikipedia.org/wiki/Proportional_hazards_model">Proportional Hazards</a> models are special cases of the WTTE-RNN. When <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-107-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="font-size: 113%; position: relative;"><span id="MJXc-Node-1325" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1326" class="mjx-mrow"><span id="MJXc-Node-1327" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.489em; padding-right: 0.007em;">β</span></span><span id="MJXc-Node-1328" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.091em; padding-bottom: 0.312em;">=</span></span><span id="MJXc-Node-1329" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">2</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>β</mi><mo>=</mo><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-107">\beta=2</script> it coincides with the <a href="https://en.wikipedia.org/wiki/Rayleigh_distribution">Rayleigh-distribution</a>.</p>

<h4 id="gradient-descent-over-weibull-surfaces">Gradient descent over Weibull surfaces</h4>
<p>Check out this simple example. I simulated some Weibull data and censored it at different thresholds. Below I show how the <a href="http://sebastianruder.com/optimizing-gradient-descent/">RMSPROP gradient descent algorithm</a> (used to train Neural Networks) tries to find its way to the correct parameters (black dotted line) from four different initializations.</p>

<p>When we have discrete data of low resolution it’s pretty clear how training works with different levels of censoring. Check the GIF below. Censoring after <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-108-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x221E;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 113%; position: relative;"><span id="MJXc-Node-1330" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1331" class="mjx-mrow"><span id="MJXc-Node-1332" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.135em; padding-bottom: 0.356em;">∞</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">∞</mi></math></span></span><script type="math/tex" id="MathJax-Element-108">\infty</script>, 2 and 1 uncensored ‘bins’ leads to 0%, 36.8%, and 77.9% of the observations being censored:</p>

<iframe allowfullscreen="true" mozallowfullscreen="true" webkitallowfullscreen="true" class="imgur-embed-iframe-pub imgur-embed-iframe-pub-0JyrJKz-true-540" scrolling="no" src="./Focus on the objective · Egils blog_files/embed(1).html" id="imgur-embed-iframe-pub-0JyrJKz" style="height: 500px; width: 540px; margin: 10px 0px; padding: 0px;"></iframe>
<script async="" src="./Focus on the objective · Egils blog_files/embed.js" charset="utf-8"></script>

<p>The vertical red dotted line in the rightmost graph marks where censoring occurs so TTE falling on the right of it are censored. See what happens at <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-109-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;77.9&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="font-size: 113%; position: relative;"><span id="MJXc-Node-1333" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1334" class="mjx-mrow"><span id="MJXc-Node-1335" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">77.9</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>77.9</mn></math></span></span><script type="math/tex" id="MathJax-Element-109">77.9</script>% censoring. Here the training data only has two different values to see: <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-110-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="font-size: 113%; position: relative;"><span id="MJXc-Node-1336" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1337" class="mjx-mrow"><span id="MJXc-Node-1338" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.489em; padding-right: 0.006em;">y</span></span><span id="MJXc-Node-1339" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.091em; padding-bottom: 0.312em;">=</span></span><span id="MJXc-Node-1340" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">0</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi><mo>=</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-110">y=0</script> or <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-111-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="font-size: 113%; position: relative;"><span id="MJXc-Node-1341" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1342" class="mjx-mrow"><span id="MJXc-Node-1343" class="mjx-texatom"><span id="MJXc-Node-1344" class="mjx-mrow"><span id="MJXc-Node-1345" class="mjx-munderover"><span class="mjx-stack"><span class="mjx-over" style="height: 0.153em; padding-bottom: 0.06em; padding-left: 0.083em;"><span id="MJXc-Node-1347" class="mjx-mo" style="vertical-align: top;"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.046em; padding-bottom: 0.312em;">~</span></span></span><span class="mjx-op"><span id="MJXc-Node-1346" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.489em; padding-right: 0.006em;">y</span></span></span></span></span></span></span><span id="MJXc-Node-1348" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.091em; padding-bottom: 0.312em;">=</span></span><span id="MJXc-Node-1349" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">1</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">~</mo></mover></mrow><mo>=</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-111">\tilde{y}=1</script>. 
All initializations reach the correct conclusion that <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-112-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;&gt;Pr&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2248;&lt;/mo&gt;&lt;mn&gt;0.21&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="font-size: 113%; position: relative;"><span id="MJXc-Node-1350" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1351" class="mjx-mrow"><span id="MJXc-Node-1352" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">Pr</span></span><span id="MJXc-Node-1353" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">(</span></span><span id="MJXc-Node-1354" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.268em; padding-right: 0.182em;">Y</span></span><span id="MJXc-Node-1355" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.091em; padding-bottom: 0.312em;">=</span></span><span id="MJXc-Node-1356" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">0</span></span><span id="MJXc-Node-1357" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">)</span></span><span id="MJXc-Node-1358" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.179em; padding-bottom: 0.312em;">≈</span></span><span id="MJXc-Node-1359" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">0.21</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo movablelimits="true" form="prefix">Pr</mo><mo stretchy="false">(</mo><mi>Y</mi><mo>=</mo><mn>0</mn><mo stretchy="false">)</mo><mo>≈</mo><mn>0.21</mn></math></span></span><script type="math/tex" id="MathJax-Element-112">\Pr(Y=0)\approx 0.21</script> but yellow and green gets stuck in local minimas leading to erronous conclusions about the right tail of the distribution.</p>

<p>With higher resolution we can get away with more censoring. Here showing training with <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-113-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x221E;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 113%; position: relative;"><span id="MJXc-Node-1360" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1361" class="mjx-mrow"><span id="MJXc-Node-1362" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.135em; padding-bottom: 0.356em;">∞</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">∞</mi></math></span></span><script type="math/tex" id="MathJax-Element-113">\infty</script>, 10 and 5 uncensored ‘bins’ which leads to 0%, 73.9% and 91.4% of observations being censored:</p>

<iframe allowfullscreen="true" mozallowfullscreen="true" webkitallowfullscreen="true" class="imgur-embed-iframe-pub imgur-embed-iframe-pub-KfE4eKz-true-540" scrolling="no" src="./Focus on the objective · Egils blog_files/embed(2).html" id="imgur-embed-iframe-pub-KfE4eKz" style="height: 500px; width: 540px; margin: 10px 0px; padding: 0px;"></iframe>
<script async="" src="./Focus on the objective · Egils blog_files/embed.js" charset="utf-8"></script>

<p>With truly continuous data it even ends up figuring it out with more than <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-114-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;99.9&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="font-size: 113%; position: relative;"><span id="MJXc-Node-1363" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1364" class="mjx-mrow"><span id="MJXc-Node-1365" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">99.9</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>99.9</mn></math></span></span><script type="math/tex" id="MathJax-Element-114">99.9</script>% censoring:</p>
<iframe allowfullscreen="true" mozallowfullscreen="true" webkitallowfullscreen="true" class="imgur-embed-iframe-pub imgur-embed-iframe-pub-zUgJdpd-true-540" scrolling="no" src="./Focus on the objective · Egils blog_files/embed(3).html" id="imgur-embed-iframe-pub-zUgJdpd" style="height: 500px; width: 540px; margin: 10px 0px; padding: 0px;"></iframe>
<script async="" src="./Focus on the objective · Egils blog_files/embed.js" charset="utf-8"></script>

<p>The takeaway is that if the way your data is being censored is <em>random enough</em> (doesn’t effect the TTE and can’t be predicted using your features) and you don’t have too coarse TTE-data, censoring isn’t much of a problem.</p>

<p>In the real world you <em>assume</em> that your TTE is Weibull given your data. Even if this is not true, by being such an expressive distribution it’s hopefully a good enough assumption/approximation of the true distribution. Let’s show it works in practice:</p>

<h1 id="implementation--experiments">Implementation &amp; Experiments</h1>
<p>All you need is your favorite step-to-step RNN-architecture (also called char-RNN) with a 2-dimensional positive output layer. I recommend using SoftPlus to output <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-115-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 113%; position: relative;"><span id="MJXc-Node-1366" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1367" class="mjx-mrow"><span id="MJXc-Node-1368" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.489em; padding-right: 0.007em;">β</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>β</mi></math></span></span><script type="math/tex" id="MathJax-Element-115">\beta</script> and exponential activation to output <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-116-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 113%; position: relative;"><span id="MJXc-Node-1369" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1370" class="mjx-mrow"><span id="MJXc-Node-1371" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">α</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>α</mi></math></span></span><script type="math/tex" id="MathJax-Element-116">\alpha</script>.</p>

<p><img src="./Focus on the objective · Egils blog_files/gEAoMQ4.png" alt="fig_rnn_weibull.png"></p>

<p>After some smart initialization you then train the network using discrete or continuous weibull-loss, here implemented in tensorflow:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">weibull_loglikelihood_continuous</span><span class="p">(</span><span class="n">a_</span><span class="p">,</span> <span class="n">b_</span><span class="p">,</span> <span class="n">y_</span><span class="p">,</span> <span class="n">u_</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="n">ya</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">y_</span><span class="o">+</span><span class="mf">1e-35</span><span class="p">,</span><span class="n">a_</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span>
        <span class="n">tf</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">u_</span><span class="p">,</span>
               <span class="n">tf</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">b_</span><span class="p">)</span><span class="o">+</span><span class="n">tf</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">b_</span><span class="p">,</span><span class="n">tf</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">ya</span><span class="p">))</span>
              <span class="p">)</span><span class="o">-</span> 
        <span class="n">tf</span><span class="o">.</span><span class="nb">pow</span><span class="p">(</span><span class="n">ya</span><span class="p">,</span><span class="n">b_</span><span class="p">)</span>
    <span class="p">)</span>

<span class="k">def</span> <span class="nf">weibull_loglikelihood_discrete</span><span class="p">(</span><span class="n">a_</span><span class="p">,</span> <span class="n">b_</span><span class="p">,</span> <span class="n">y_</span><span class="p">,</span> <span class="n">u_</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">tf</span><span class="o">.</span><span class="n">name_scope</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
        <span class="n">hazard0</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="nb">pow</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">y_</span><span class="o">+</span><span class="mf">1e-35</span><span class="p">,</span><span class="n">a_</span><span class="p">),</span><span class="n">b_</span><span class="p">)</span> 
        <span class="n">hazard1</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="nb">pow</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">y_</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">a_</span><span class="p">),</span><span class="n">b_</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">u_</span><span class="p">,</span><span class="n">tf</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">hazard1</span><span class="o">-</span><span class="n">hazard0</span><span class="p">)</span><span class="o">-</span><span class="mf">1.0</span><span class="p">))</span><span class="o">-</span><span class="n">hazard1</span><span class="p">)</span></code></pre></figure>

<p>It’s not pretty but it works like a charm. It even has an inbuilt regularization mechanism. We can add a penalty function that blows up when <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-117-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 113%; position: relative;"><span id="MJXc-Node-1372" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1373" class="mjx-mrow"><span id="MJXc-Node-1374" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.489em; padding-right: 0.007em;">β</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>β</mi></math></span></span><script type="math/tex" id="MathJax-Element-117">\beta</script> becomes large. This prevents large values of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-118-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 113%; position: relative;"><span id="MJXc-Node-1375" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1376" class="mjx-mrow"><span id="MJXc-Node-1377" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.489em; padding-right: 0.007em;">β</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>β</mi></math></span></span><script type="math/tex" id="MathJax-Element-118">\beta</script> hence controls the peakedness of the predicted distribution.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">weibull_beta_penalty</span><span class="p">(</span><span class="n">b_</span><span class="p">,</span><span class="n">location</span> <span class="o">=</span> <span class="mf">10.0</span><span class="p">,</span> <span class="n">growth</span><span class="o">=</span><span class="mf">20.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="c"># Regularization term to keep beta below location
</span>
    <span class="k">with</span> <span class="n">tf</span><span class="o">.</span><span class="n">name_scope</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
        <span class="n">scale</span> <span class="o">=</span> <span class="n">growth</span><span class="o">/</span><span class="n">location</span>
        <span class="n">penalty_</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">scale</span><span class="o">*</span><span class="p">(</span><span class="n">b_</span><span class="o">-</span><span class="n">location</span><span class="p">))</span>
    <span class="k">return</span><span class="p">(</span><span class="n">penalty_</span><span class="p">)</span></code></pre></figure>

<p>There’s other simple extensions. We could for example extend it to multivariate TTE’s by just widening the output layer together with some covariance structure but that’s for another blogpost.</p>

<h2 id="predicting-evenly-spaced-points">Predicting evenly spaced points</h2>
<p>Let’s try a simple example. Each training sequence is a randomly shifted sequence of evenly spaced points. The goal is to sequentially predict the number of steps to the next point. Each sequence consists of 100 timesteps. The feature data is a lagged event indicator:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-119-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;{&lt;/mo&gt;&lt;mtable columnalign=&quot;left left&quot; rowspacing=&quot;.2em&quot; columnspacing=&quot;1em&quot; displaystyle=&quot;false&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mtext&gt;If last step had an event&lt;/mtext&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mtext&gt;else&lt;/mtext&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo fence=&quot;true&quot; stretchy=&quot;true&quot; symmetric=&quot;true&quot;&gt;&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 113%; text-align: center; position: relative;"><span id="MJXc-Node-1378" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1379" class="mjx-mrow"><span id="MJXc-Node-1380" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1381" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1382" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span><span id="MJXc-Node-1383" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.091em; padding-bottom: 0.312em;">=</span></span><span id="MJXc-Node-1384" class="mjx-mrow MJXc-space3"><span id="MJXc-Node-1385" class="mjx-mo"><span class="mjx-char MJXc-TeX-size3-R" style="padding-top: 1.241em; padding-bottom: 1.241em;">{</span></span><span id="MJXc-Node-1386" class="mjx-mtable" style="vertical-align: -0.86em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-1387" class="mjx-mtr" style="height: 1.119em;"><span id="MJXc-Node-1388" class="mjx-mtd" style="padding: 0px 0.5em 0px 0px; text-align: left; width: 0.5em;"><span id="MJXc-Node-1389" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1390" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">1</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1391" class="mjx-mtd" style="padding: 0px 0px 0px 0.5em; text-align: left; width: 10.29em;"><span id="MJXc-Node-1392" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1393" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.533em;">If last step had an event</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-1394" class="mjx-mtr" style="height: 1.1em;"><span id="MJXc-Node-1395" class="mjx-mtd" style="padding: 0.1em 0.5em 0px 0px; text-align: left;"><span id="MJXc-Node-1396" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1397" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">0</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1398" class="mjx-mtd" style="padding: 0.1em 0px 0px 0.5em; text-align: left;"><span id="MJXc-Node-1399" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-1400" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">else</span></span><span class="mjx-strut"></span></span></span></span></span></span><span id="MJXc-Node-1401" class="mjx-mo" style="width: 0.12em;"></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>x</mi><mi>t</mi></msub><mo>=</mo><mrow><mo>{</mo><mtable columnalign="left left" rowspacing=".2em" columnspacing="1em" displaystyle="false"><mtr><mtd><mn>1</mn></mtd><mtd><mtext>If last step had an event</mtext></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mtext>else</mtext></mtd></mtr></mtable><mo fence="true" stretchy="true" symmetric="true"></mo></mrow></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-119">% <![CDATA[
x_t=
\begin{cases}
1 & \text{If last step had an event}\\
0 & \text{else}\\
\end{cases} %]]></script>

<iframe allowfullscreen="true" mozallowfullscreen="true" webkitallowfullscreen="true" class="imgur-embed-iframe-pub imgur-embed-iframe-pub-eR2OPmP-true-540" scrolling="no" src="./Focus on the objective · Egils blog_files/embed(4).html" id="imgur-embed-iframe-pub-eR2OPmP" style="height: 500px; width: 540px; margin: 10px 0px; padding: 0px;"></iframe>
<script async="" src="./Focus on the objective · Egils blog_files/embed.js" charset="utf-8"></script>

<p>The network is a tiny LSTM with a recurrent state size 10 so <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-120-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="font-size: 113%; position: relative;"><span id="MJXc-Node-1402" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1403" class="mjx-mrow"><span id="MJXc-Node-1404" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">1</span></span><span id="MJXc-Node-1405" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.223em; padding-bottom: 0.312em;">×</span></span><span id="MJXc-Node-1406" class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">10</span></span><span id="MJXc-Node-1407" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.223em; padding-bottom: 0.312em;">×</span></span><span id="MJXc-Node-1408" class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">2</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn><mo>×</mo><mn>10</mn><mo>×</mo><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-120">1\times 10 \times 2</script> neurons altogether. I still had to penalize it as discussed above to avoid perfect fit and numerical instability. During training the network only got to see the censored target value in the last (rightmost) steps. I tried this using 100, 75, 50 and 25 steps between the points.</p>

<p>Check the results (true TTE superimposed in black, censored dotted black), it worked really well except at spacing 100 (first pic) where it goes nuts :</p>

<iframe allowfullscreen="true" mozallowfullscreen="true" webkitallowfullscreen="true" class="imgur-embed-iframe-pub imgur-embed-iframe-pub-Cjz1yfm-true-540" scrolling="no" src="./Focus on the objective · Egils blog_files/embed(5).html" id="imgur-embed-iframe-pub-Cjz1yfm" style="height: 500px; width: 540px; margin: 10px 0px; padding: 0px;"></iframe>
<script async="" src="./Focus on the objective · Egils blog_files/embed.js" charset="utf-8"></script>

<iframe allowfullscreen="true" mozallowfullscreen="true" webkitallowfullscreen="true" class="imgur-embed-iframe-pub imgur-embed-iframe-pub-6s17rOU-true-540" scrolling="no" src="./Focus on the objective · Egils blog_files/embed(6).html" id="imgur-embed-iframe-pub-6s17rOU" style="height: 500px; width: 540px; margin: 10px 0px; padding: 0px;"></iframe>
<script async="" src="./Focus on the objective · Egils blog_files/embed.js" charset="utf-8"></script>

<iframe allowfullscreen="true" mozallowfullscreen="true" webkitallowfullscreen="true" class="imgur-embed-iframe-pub imgur-embed-iframe-pub-xTzd7KT-true-540" scrolling="no" src="./Focus on the objective · Egils blog_files/embed(7).html" id="imgur-embed-iframe-pub-xTzd7KT" style="height: 500px; width: 540px; margin: 10px 0px; padding: 0px;"></iframe>
<script async="" src="./Focus on the objective · Egils blog_files/embed.js" charset="utf-8"></script>

<iframe allowfullscreen="true" mozallowfullscreen="true" webkitallowfullscreen="true" class="imgur-embed-iframe-pub imgur-embed-iframe-pub-klNuiZe-true-540" scrolling="no" src="./Focus on the objective · Egils blog_files/embed(8).html" id="imgur-embed-iframe-pub-klNuiZe" style="height: 500px; width: 540px; margin: 10px 0px; padding: 0px;"></iframe>
<script async="" src="./Focus on the objective · Egils blog_files/embed.js" charset="utf-8"></script>

<p>In the first pic the spacing was so wide that it only trained on one event at a time, meaning it never got to train on uncensored TTE’s after the first event. This incentivices it to always push predicted location up after seeing an event. In doing so it gets it wrong, but it’s honest about not being sure!</p>

<p>In my thesis I compared this with methods like disregarding the censored datapoints or treating them like uncensored. When not explicitly modeling censoring I ended up getting extremely confident <em>and</em> completely wrong predictions. Taking censoring into account won on test set every time.</p>

<h2 id="predicting-the-destruction-of-jet-engines">Predicting the destruction of jet-engines</h2>
<p>There’s a pretty cool dataset called the C-MAPSSS, or the <a href="https://ti.arc.nasa.gov/tech/dash/pcoe/prognostic-data-repository/">Turbofan Engine Degradation Simulation Data Set
</a>. The subset of data used here consists of 418 sequences of 26-dimensional jet-engine sensor-readings which is used to sequentially predict the time to failure (also called Remaining Useful Life/RUL). Here we don’t have censored data but it’s an interesting example anyway.</p>

<p>I used a vanilla LSTM with width 100 of the recurrent state and a 10-node hidden layer (<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-121-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;26&lt;/mn&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;mn&gt;100&lt;/mn&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="font-size: 113%; position: relative;"><span id="MJXc-Node-1409" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1410" class="mjx-mrow"><span id="MJXc-Node-1411" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">26</span></span><span id="MJXc-Node-1412" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.223em; padding-bottom: 0.312em;">×</span></span><span id="MJXc-Node-1413" class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">100</span></span><span id="MJXc-Node-1414" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.223em; padding-bottom: 0.312em;">×</span></span><span id="MJXc-Node-1415" class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">10</span></span><span id="MJXc-Node-1416" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.223em; padding-bottom: 0.312em;">×</span></span><span id="MJXc-Node-1417" class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">2</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>26</mn><mo>×</mo><mn>100</mn><mo>×</mo><mn>10</mn><mo>×</mo><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-121">26 \times 100 \times 10 \times 2</script>). With little to no hyperparameter-search I managed to get competitive results. The predicted output for some sequence that failed after 130 cycles looks something like this:</p>

<p><img src="./Focus on the objective · Egils blog_files/kapWXMD.png" alt="it_61786_pmf_stack_151.png">
It’s pretty mesmerizing how the distribution becomes tighter and tighter as the engine starts to break down. Both the predicted expected value and the MAP (mode) gets closer and closer to the target. How does this translate to churn?</p>

<h2 id="how-to-use-wtte-rnn-as-a-churn-model">How to use WTTE-RNN as a churn-model</h2>
<p>In churn-prediction I’ve argued that you’re really interested in <em>non events</em>. Instead of focusing on the events we focus on the void, i.e the <em>time between events</em>. As you know the time since an event in real time you only need to predict the time <em>to</em> events.</p>

<table>
  <tbody>
    <tr>
      <td>Ground-truth-world</td>
      <td>actual churners</td>
      <td>customer with TTE <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-122-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 113%; position: relative;"><span id="MJXc-Node-1418" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1419" class="mjx-mrow"><span id="MJXc-Node-1420" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-1421" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.489em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1422" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span><span id="MJXc-Node-1423" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.268em; padding-bottom: 0.4em;">&gt;</span></span><span id="MJXc-Node-1424" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.312em; padding-right: 0.08em;">τ</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>y</mi><mi>t</mi></msub><mo>&gt;</mo><mi>τ</mi></math></span></span><script type="math/tex" id="MathJax-Element-122">y_t>\tau</script> <strong>is</strong> churned</td>
    </tr>
    <tr>
      <td>Prediction world</td>
      <td>predicted churners</td>
      <td><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-123-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;&gt;Pr&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="font-size: 113%; position: relative;"><span id="MJXc-Node-1425" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1426" class="mjx-mrow"><span id="MJXc-Node-1427" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">Pr</span></span><span id="MJXc-Node-1428" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">(</span></span><span id="MJXc-Node-1429" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.182em;"><span id="MJXc-Node-1430" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.268em; padding-right: 0.182em;">Y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1431" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span><span id="MJXc-Node-1432" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.356em; padding-bottom: 0.489em;">≤</span></span><span id="MJXc-Node-1433" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.312em; padding-right: 0.08em;">τ</span></span><span id="MJXc-Node-1434" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">)</span></span><span id="MJXc-Node-1435" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.268em; padding-bottom: 0.4em;">&lt;</span></span><span id="MJXc-Node-1436" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-1437" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.268em;">θ</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1438" class="mjx-mo" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.179em; padding-bottom: 0.312em;">∗</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo movablelimits="true" form="prefix">Pr</mo><mo stretchy="false">(</mo><msub><mi>Y</mi><mi>t</mi></msub><mo>≤</mo><mi>τ</mi><mo stretchy="false">)</mo><mo>&lt;</mo><msup><mi>θ</mi><mo>∗</mo></msup></math></span></span><script type="math/tex" id="MathJax-Element-123">% <![CDATA[
\Pr(Y_t\leq \tau)<\theta^* %]]></script> the customer is <strong>predicted</strong> as churned</td>
    </tr>
    <tr>
      <td>training world</td>
      <td>observed churners</td>
      <td>If <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-124-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 113%; position: relative;"><span id="MJXc-Node-1439" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1440" class="mjx-mrow"><span id="MJXc-Node-1441" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-1442" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.489em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1443" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span><span id="MJXc-Node-1444" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.268em; padding-bottom: 0.4em;">&lt;</span></span><span id="MJXc-Node-1445" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.312em; padding-right: 0.08em;">τ</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>y</mi><mi>t</mi></msub><mo>&lt;</mo><mi>τ</mi></math></span></span><script type="math/tex" id="MathJax-Element-124">% <![CDATA[
y_t<\tau %]]></script> customer <strong>was</strong> active. If <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-125-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2265;&lt;/mo&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 113%; position: relative;"><span id="MJXc-Node-1446" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1447" class="mjx-mrow"><span id="MJXc-Node-1448" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1449" class="mjx-texatom"><span id="MJXc-Node-1450" class="mjx-mrow"><span id="MJXc-Node-1451" class="mjx-munderover"><span class="mjx-stack"><span class="mjx-over" style="height: 0.213em; padding-bottom: 0.06em; padding-left: 0.083em;"><span id="MJXc-Node-1453" class="mjx-mo" style="vertical-align: top;"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.312em;">^</span></span></span><span class="mjx-op"><span id="MJXc-Node-1452" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.489em; padding-right: 0.006em;">y</span></span></span></span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.375em; padding-right: 0.071em;"><span id="MJXc-Node-1454" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.4em; padding-bottom: 0.268em;">t</span></span></span></span><span id="MJXc-Node-1455" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.356em; padding-bottom: 0.489em;">≥</span></span><span id="MJXc-Node-1456" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.312em; padding-right: 0.08em;">τ</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mi>t</mi></msub><mo>≥</mo><mi>τ</mi></math></span></span><script type="math/tex" id="MathJax-Element-125">\hat{y}_t\geq\tau</script> customer <strong>was</strong> churned</td>
    </tr>
  </tbody>
</table>

<p>Just like with the sliding-box model’s definition of churn we can estimate the probability of event within some fixed time window such as <em>if probability of purchase within <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-126-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;100&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="font-size: 113%; position: relative;"><span id="MJXc-Node-1457" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1458" class="mjx-mrow"><span id="MJXc-Node-1459" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.312em; padding-right: 0.08em;">τ</span></span><span id="MJXc-Node-1460" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.091em; padding-bottom: 0.312em;">=</span></span><span id="MJXc-Node-1461" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">100</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>τ</mi><mo>=</mo><mn>100</mn></math></span></span><script type="math/tex" id="MathJax-Element-126">\tau=100</script> days is less than <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-127-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0.01&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="font-size: 113%; position: relative;"><span id="MJXc-Node-1462" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1463" class="mjx-mrow"><span id="MJXc-Node-1464" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1465" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.268em;">θ</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1466" class="mjx-mo" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.179em; padding-bottom: 0.312em;">∗</span></span></span></span><span id="MJXc-Node-1467" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.091em; padding-bottom: 0.312em;">=</span></span><span id="MJXc-Node-1468" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">0.01</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>θ</mi><mo>∗</mo></msup><mo>=</mo><mn>0.01</mn></math></span></span><script type="math/tex" id="MathJax-Element-127">\theta^*=0.01</script> customer is churned</em>. The big difference is that we can decide which threshold to use <em>after</em> the model is trained and we can extrapolate to set <em>any</em> threshold, like <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-128-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C4;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;200&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="font-size: 113%; position: relative;"><span id="MJXc-Node-1469" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1470" class="mjx-mrow"><span id="MJXc-Node-1471" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.312em; padding-right: 0.08em;">τ</span></span><span id="MJXc-Node-1472" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.091em; padding-bottom: 0.312em;">=</span></span><span id="MJXc-Node-1473" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">200</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>τ</mi><mo>=</mo><mn>200</mn></math></span></span><script type="math/tex" id="MathJax-Element-128">\tau=200</script> even if your company only existed for 100 days.</p>

<p>The WTTE-RNN does involve a leap of faith as we’re making assumptions, arguably a more intricate assumption than with the sliding box model. Unlike with the Sliding Box model you may use the latest data for training. Not doing so is also an assumption.</p>

<p>With a distribution we get much richer predictions giving us room to define a more sensitive and interpretable churn-definition.
We can also use it to derive and predict a bunch of other interesting metrics that might interface with your KPI’s like DAUs and MAUs. It should also be a good start for predicting the dreadedly hard concept of Customer Lifetime Value (lifetime or next years payments is a censored datapoint).</p>

<p>But wait! There’s more..</p>

<h3 id="wtte-rnn-produces-risk-embeddings">WTTE-RNN produces risk-embeddings</h3>
<p>Your predicted parameters creates a 2-d embedding (vector representation) for each of your customers current predicted activity level. 
The parameters of the Weibull-distribution has a nice interpretation. <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-129-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 113%; position: relative;"><span id="MJXc-Node-1474" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1475" class="mjx-mrow"><span id="MJXc-Node-1476" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">α</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>α</mi></math></span></span><script type="math/tex" id="MathJax-Element-129">\alpha</script> is a location parameter (like <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-130-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03BC;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 113%; position: relative;"><span id="MJXc-Node-1477" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1478" class="mjx-mrow"><span id="MJXc-Node-1479" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.489em;">μ</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>μ</mi></math></span></span><script type="math/tex" id="MathJax-Element-130">\mu</script> for the normal distribution) so it gives us a prediction about <em>when</em>. <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-131-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 113%; position: relative;"><span id="MJXc-Node-1480" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1481" class="mjx-mrow"><span id="MJXc-Node-1482" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">1</span></span><span id="MJXc-Node-1483" class="mjx-texatom"><span id="MJXc-Node-1484" class="mjx-mrow"><span id="MJXc-Node-1485" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.577em;">/</span></span></span></span><span id="MJXc-Node-1486" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.489em; padding-right: 0.007em;">β</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi>β</mi></math></span></span><script type="math/tex" id="MathJax-Element-131">1/\beta</script> is a scale parameter (like <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-132-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 113%; position: relative;"><span id="MJXc-Node-1487" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1488" class="mjx-mrow"><span id="MJXc-Node-1489" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em; padding-right: 0.001em;">σ</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>σ</mi></math></span></span><script type="math/tex" id="MathJax-Element-132">\sigma</script>) so <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-133-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 113%; position: relative;"><span id="MJXc-Node-1490" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1491" class="mjx-mrow"><span id="MJXc-Node-1492" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.489em; padding-right: 0.007em;">β</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>β</mi></math></span></span><script type="math/tex" id="MathJax-Element-133">\beta</script> is roughly a prediction about <em>dispersion</em> or how sure we are about the location.</p>

<p>This means that plotting them gives you a neat tool to monitor your whole customer base. You might even find yourself with <em>valuable business insights™</em>!</p>

<p>From the C-MAPSS example, when plotting the predicted parameters for all the jet engines and their timesteps some weird pattern emerges. The alpha-baseline is the raw target value mean and the beta-baseline separates decreasing (<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-134-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="font-size: 113%; position: relative;"><span id="MJXc-Node-1493" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1494" class="mjx-mrow"><span id="MJXc-Node-1495" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.489em; padding-right: 0.007em;">β</span></span><span id="MJXc-Node-1496" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.268em; padding-bottom: 0.4em;">&lt;</span></span><span id="MJXc-Node-1497" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">1</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>β</mi><mo>&lt;</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-134">% <![CDATA[
\beta<1 %]]></script>) or increasing (<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-135-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="font-size: 113%; position: relative;"><span id="MJXc-Node-1498" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1499" class="mjx-mrow"><span id="MJXc-Node-1500" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.489em; padding-right: 0.007em;">β</span></span><span id="MJXc-Node-1501" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.268em; padding-bottom: 0.4em;">&gt;</span></span><span id="MJXc-Node-1502" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">1</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>β</mi><mo>&gt;</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-135">\beta>1</script>) risk.</p>

<p><img src="./Focus on the objective · Egils blog_files/8o0bHLu.png" alt="61786_alphabetaplot.png">
Adding time as a third axis it looks like each jet engine takes a walk on this graph. I superimposed the predicted parameters from the individual jet engine shown previously:</p>

<p><img src="./Focus on the objective · Egils blog_files/dEUj9Qe.png" alt="61786_scatter3dplot_151.png">
This engine took a semi-random walk from the far right corner to the bottom left corner. All engines seemed to traverse this graph in a similar fashion.</p>

<p>We could name each region in some smart way. The peak (<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-136-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mo&gt;&amp;#x2248;&lt;/mo&gt;&lt;mn&gt;50&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="font-size: 113%; position: relative;"><span id="MJXc-Node-1503" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1504" class="mjx-mrow"><span id="MJXc-Node-1505" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.223em; padding-bottom: 0.268em;">α</span></span><span id="MJXc-Node-1506" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.179em; padding-bottom: 0.312em;">≈</span></span><span id="MJXc-Node-1507" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">50</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>α</mi><mo>≈</mo><mn>50</mn></math></span></span><script type="math/tex" id="MathJax-Element-136">\alpha\approx 50</script>, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-137-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="font-size: 113%; position: relative;"><span id="MJXc-Node-1508" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1509" class="mjx-mrow"><span id="MJXc-Node-1510" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.489em; padding-right: 0.007em;">β</span></span><span id="MJXc-Node-1511" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.268em; padding-bottom: 0.4em;">&gt;</span></span><span id="MJXc-Node-1512" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.4em; padding-bottom: 0.356em;">2</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>β</mi><mo>&gt;</mo><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-137">\beta> 2</script>) could for example be called ‘known failure onset’. Think what this plot could mean for analysing your customer onboarding process and where each customer is in it <em>now</em>.</p>

<p>So despite giving us a bunch of different alternatives to create a fixed churn-definition such as deciding threshold on what the predicted expected value, quantile or something else we can choose regions in the Weibull-plot and name them. 
As an example, if <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-138-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 113%; position: relative;"><span id="MJXc-Node-1513" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1514" class="mjx-mrow"><span id="MJXc-Node-1515" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.489em; padding-bottom: 0.489em; padding-right: 0.007em;">β</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>β</mi></math></span></span><script type="math/tex" id="MathJax-Element-138">\beta</script> is really high we’re pretty sure about when the next event will be even if it’s far away. Maybe they are christmas-shoppers?</p>

<p>We could get a richer, but less intuitive, embedding by choosing to store the whole hidden RNN-state and use it for clustering or as features for other models. Think Word2Vec for churn.</p>

<p>There’s a bunch of other ways that we can use WTTE-RNN to visualize the health of your whole customer stock through time and the current prediction: Take individual timelines and stack them on top of eachother. This gives us a graph showing the prediction and how it varied through time. Let’s get back to the jet-engine test set.</p>

<p>By coloring the timelines with their predicted <strong>alpha</strong>:</p>
<iframe allowfullscreen="true" mozallowfullscreen="true" webkitallowfullscreen="true" class="imgur-embed-iframe-pub imgur-embed-iframe-pub-Yo1QPxU-true-540" scrolling="no" src="./Focus on the objective · Egils blog_files/embed(9).html" id="imgur-embed-iframe-pub-Yo1QPxU" style="height: 500px; width: 540px; margin: 10px 0px; padding: 0px;"></iframe>
<script async="" src="./Focus on the objective · Egils blog_files/embed.js" charset="utf-8"></script>

<p>It tells tell us about the predicted time to <em>future events</em> from each point in time. Every horizontal line is a jet-engine and its predicted (alpha) value. Here the prediction goes from healthy <em>far away</em>-red to worrying <em>anytime soon!</em>-blue</p>

<p>By coloring them by their predicted <strong>beta</strong>:</p>
<iframe allowfullscreen="true" mozallowfullscreen="true" webkitallowfullscreen="true" class="imgur-embed-iframe-pub imgur-embed-iframe-pub-LGacYzO-true-540" scrolling="no" src="./Focus on the objective · Egils blog_files/embed(10).html" id="imgur-embed-iframe-pub-LGacYzO" style="height: 500px; width: 540px; margin: 10px 0px; padding: 0px;"></iframe>
<script async="" src="./Focus on the objective · Egils blog_files/embed.js" charset="utf-8"></script>

<p>It tells us how confident the predictions where. It seems like the confidence was the highest (red) at what looks like the onset of degradating health.</p>

<p>Here the xlab <em>time</em> means survival time but for a customer database it would be a fixed date so it’d show a <a href="https://imgur.com/JT60TnL">timeline of cohorts</a>. This could give you a realtime prediction of current churn (by threshold in the right tail say) and DAU (thresholding in the left tail). By taking mean over the prediction you would get a predicted <em>rate</em> for all your customers.</p>

<h1 id="summary">Summary</h1>
<p>To summarise, the WTTE-RNN can:</p>

<ul>
  <li>Handle discrete or continuous time</li>
  <li>Train on censored data</li>
  <li>use temporal features/time varying covariates</li>
  <li>Learn long-term temporal patterns</li>
</ul>

<p>And it’s less hacky than the sliding box model as you don’t need to set some arbitrary window size before training your model. The whole modeling cycle just gets smoother. You can use all your available data and you get output that’s interpretable.</p>

<p>There are assumptions (it’s a <em>model</em>, not reality), but they are explicit - no hidden or dirty tricks:</p>

<ul>
  <li>Assume the time to event to be Weibull distributed given features</li>
  <li>Assume uninformative censoring</li>
</ul>

<h4 id="links">links</h4>

<p>My master thesis <a href="https://ragulpr.github.io/assets/draft_master_thesis_martinsson_egil_wtte_rnn_2016.pdf"><del>temp link</del></a> <a href="http://publications.lib.chalmers.se/records/fulltext/253611/253611.pdf">permanent link</a>.</p>

<blockquote>
  <p><em>WTTE-RNN : Weibull Time To Event Recurrent Neural Network</em></p>

  <p><em>A model for sequential prediction of time-to-event in the case of discrete or continuous censored data, recurrent events or time-varying covariates</em></p>
</blockquote>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>@MastersThesis{martinsson:Thesis:2016,
    author     =     {Egil Martinsson},
    title     =     {WTTE-RNN : Weibull Time To Event Recurrent Neural Network},
    school     =     {Chalmers University Of Technology},
    year     =     {2016}
    }
</code></pre></div></div>

<ul>
  <li><a href="https://docs.microsoft.com/sv-se/azure/machine-learning/cortana-analytics-playbook-predictive-maintenance">Cortana intelligence, not churn but (machine)failure-prediction framed as binary, multiclass or a regression problem (not a censored problem). Nice walktrough of whole modeling process</a></li>
  <li><a href="http://alexminnaar.com/my-experience-with-churn-analysis.html">Alex Minnaar, overview focusing on class imbalance. Framing it as predicting those who cancel “soon”</a></li>
  <li><a href="https://docs.microsoft.com/sv-se/azure/machine-learning/machine-learning-azure-ml-customer-churn-scenario">Microsoft azure, nice overview</a></li>
  <li><a href="http://www.wiseathena.com/pdf/wa_dl.pdf">Using Deep Learning to Predict Customer Churn in a
Mobile Telecommunication Network</a></li>
  <li>Not ML but really nice concise parametric survival approaches to churn and similar problems <a href="https://github.com/CamDavidsonPilon/lifetimes/">lifetimes</a>, <a href="https://github.com/CamDavidsonPilon/lifelines">lifelines</a> and <a href="https://cran.r-project.org/web/packages/BTYD/vignettes/BTYD-walkthrough.pdf">BTYD</a></li>
  <li>My <a href="http://ragulpr.imgur.com/">imgur albums</a></li>
  <li><a href="https://github.com/gm-spacagna/deep-ttf">Great analysis and practical thoughts on using WTTE for jet-engine failure time prediction by Gianmario Spacagna</a></li>
</ul>

<p>ps. I’m sure alot of people have built this model or variants of it previously but I haven’t been able to find any papers on it. If you have and want to discuss it/be cited please get in touch!</p>

<p><del>I’m currently working on cleaning up some research-grade dirty code to put it on github. PM me if you can’t wait.</del> EDIT : Just released some code <a href="https://github.com/ragulpr/wtte-rnn/">https://github.com/ragulpr/wtte-rnn/</a></p>

  </div>
  
</div>

<div class="pagination">
  
    <span class="pagination-item older">Older</span>
  
  
    
      <a class="pagination-item newer" href="https://ragulpr.github.io/">Newer</a>
    
  
</div>


      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

    <script>
      (function(document) {
        var toggle = document.querySelector('.sidebar-toggle');
        var sidebar = document.querySelector('#sidebar');
        var checkbox = document.querySelector('#sidebar-checkbox');

        document.addEventListener('click', function(e) {
          var target = e.target;

          if(!checkbox.checked ||
             sidebar.contains(target) ||
             (target === checkbox || target === toggle)) return;

          checkbox.checked = false;
        }, false);
      })(document);
    </script>
    
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-89494898-1', 'auto');
  ga('send', 'pageview');

</script>
    
  

</body></html>